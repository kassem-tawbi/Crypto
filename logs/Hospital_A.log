2025-11-10 12:10:45 [INFO] [Hospital_A] Initializing node with cryptographic material...
2025-11-10 12:10:45 [INFO] [Hospital_A] Loading private key from 'Hospital_A_private.pem'...
2025-11-10 12:10:45 [INFO] [Hospital_A] PrivateKeyLoaded | source=Hospital_A_private.pem
2025-11-10 12:10:45 [INFO] [Hospital_A] Loading public key for Hospital_A from 'Hospital_A_public.pem'...
2025-11-10 12:10:45 [INFO] [Hospital_A] PublicKeyLoaded | owner=Hospital_A | source=Hospital_A_public.pem
2025-11-10 12:10:45 [INFO] [Hospital_A] Loading public key for Hospital_B from 'Hospital_B_public.pem'...
2025-11-10 12:10:45 [INFO] [Hospital_A] PublicKeyLoaded | owner=Hospital_B | source=Hospital_B_public.pem
2025-11-10 12:10:45 [INFO] [Hospital_A] Directories ready: data_dir='hospital_A_data', received_dir='hospital_A_received'
2025-11-10 12:10:45 [INFO] [Hospital_A] Background server thread started.
2025-11-10 12:10:45 [INFO] [Hospital_A] Node running. This CLI is for testing. In production, drive approvals & requests via a real UI.
2025-11-10 12:10:45 [INFO] [Hospital_A] Server listening on 0.0.0.0:65001
2025-11-10 12:10:58 [INFO] [Hospital_A] SignMessage_Start | algo=RSA | hash=SHA-256 | message_preview=Request:patient_123.txt
2025-11-10 12:10:58 [INFO] [Hospital_A] SignMessage_Done | signature_len=256 | signature_preview=8c7219e2facbbe52f41efc7a7921e5b3...
2025-11-10 12:10:58 [INFO] [Hospital_A] Connecting to Hospital_B at 127.0.0.1:65002...
2025-11-10 12:10:58 [INFO] [Hospital_A] Sending secure request for 'patient_123.txt' to Hospital_B...
2025-11-10 12:11:15 [INFO] [Hospital_A] Encrypted package received. Decoding...
2025-11-10 12:11:15 [INFO] [Hospital_A] EncryptedPackage_Received | enc_keys_len=256 | iv_hex=ffc9858ae1ce985d4d17f86b3f373120 | ciphertext_len=112 | hmac_len=32 | hmac_preview=b1506b5a9ae494e3863388618f1ba1d0...
2025-11-10 12:11:15 [INFO] [Hospital_A] RSA_DecryptKeys_Start | algo=RSA | enc_keys_len=256
2025-11-10 12:11:15 [INFO] [Hospital_A] RSA_DecryptKeys_Done | combined_len=64 | combined_preview=e63c545412bfb06e16851745497cb740...
2025-11-10 12:11:15 [INFO] [Hospital_A] SessionKeys_Derived | aes_key_len=32 | aes_key_preview=e63c545412bfb06e... | hmac_key_len=32 | hmac_key_preview=9a1f91fbe99b5bc2...
2025-11-10 12:11:15 [INFO] [Hospital_A] HMAC_Verify_Start | algo=HMAC-SHA256 | ciphertext_len=112
2025-11-10 12:11:15 [INFO] [Hospital_A] HMAC_Verify_Success | note=Integrity OK
2025-11-10 12:11:15 [INFO] [Hospital_A] AES_Decrypt_Start | algo=AES-256-CBC | ciphertext_len=112 | iv_hex=ffc9858ae1ce985d4d17f86b3f373120
2025-11-10 12:11:15 [INFO] [Hospital_A] AES_Decrypt_Done | plaintext_len=103 | plaintext_preview=50415449454e54205245434f52443a20...
2025-11-10 12:11:15 [INFO] [Hospital_A] Decrypted record saved to 'hospital_A_received\RECEIVED_patient_123.txt'
2025-11-10 12:14:29 [INFO] [Hospital_A] Shutting down by user request...
2025-11-10 12:14:29 [INFO] [Hospital_A] Server stop signal set.
2025-11-10 12:14:54 [INFO] [Hospital_A] Initializing node with cryptographic material...
2025-11-10 12:14:54 [INFO] [Hospital_A] Loading private key from 'Hospital_A_private.pem'...
2025-11-10 12:14:54 [INFO] [Hospital_A] PrivateKeyLoaded | source=Hospital_A_private.pem
2025-11-10 12:14:54 [INFO] [Hospital_A] Loading public key for Hospital_A from 'Hospital_A_public.pem'...
2025-11-10 12:14:54 [INFO] [Hospital_A] PublicKeyLoaded | owner=Hospital_A | source=Hospital_A_public.pem
2025-11-10 12:14:54 [INFO] [Hospital_A] Loading public key for Hospital_B from 'Hospital_B_public.pem'...
2025-11-10 12:14:54 [INFO] [Hospital_A] PublicKeyLoaded | owner=Hospital_B | source=Hospital_B_public.pem
2025-11-10 12:14:54 [INFO] [Hospital_A] Directories ready: data_dir='hospital_A_data', received_dir='hospital_A_received'
2025-11-10 12:14:54 [INFO] [Hospital_A] Background server thread started.
2025-11-10 12:14:54 [INFO] [Hospital_A] Node running. This CLI is for testing. In production, drive approvals & requests via a real UI.
2025-11-10 12:14:54 [INFO] [Hospital_A] Server listening on 0.0.0.0:65001
2025-11-10 12:14:56 [INFO] [Hospital_A] Shutting down by user request...
2025-11-10 12:14:56 [INFO] [Hospital_A] Server stop signal set.
2025-11-10 12:20:24 [INFO] [Hospital_A] Initializing node with cryptographic material...
2025-11-10 12:20:24 [INFO] [Hospital_A] Loading private key from 'Hospital_A_private.pem'...
2025-11-10 12:20:24 [INFO] [Hospital_A] PrivateKeyLoaded | source=Hospital_A_private.pem
2025-11-10 12:20:24 [INFO] [Hospital_A] Loading public key for Hospital_A from 'Hospital_A_public.pem'...
2025-11-10 12:20:24 [INFO] [Hospital_A] PublicKeyLoaded | owner=Hospital_A | source=Hospital_A_public.pem
2025-11-10 12:20:24 [INFO] [Hospital_A] Loading public key for Hospital_B from 'Hospital_B_public.pem'...
2025-11-10 12:20:24 [INFO] [Hospital_A] PublicKeyLoaded | owner=Hospital_B | source=Hospital_B_public.pem
2025-11-10 12:20:24 [INFO] [Hospital_A] Directories ready: data_dir='hospital_A_data', received_dir='hospital_A_received'
2025-11-10 12:20:24 [INFO] [Hospital_A] Background server thread started.
2025-11-10 12:20:24 [INFO] [Hospital_A] Server listening on 0.0.0.0:65001
2025-11-10 12:23:57 [INFO] [Hospital_A] Initializing node with cryptographic material...
2025-11-10 12:23:57 [INFO] [Hospital_A] Loading private key from 'Hospital_A_private.pem'...
2025-11-10 12:23:57 [INFO] [Hospital_A] PrivateKeyLoaded | source=Hospital_A_private.pem
2025-11-10 12:23:57 [INFO] [Hospital_A] Loading public key for Hospital_A from 'Hospital_A_public.pem'...
2025-11-10 12:23:57 [INFO] [Hospital_A] PublicKeyLoaded | owner=Hospital_A | source=Hospital_A_public.pem
2025-11-10 12:23:57 [INFO] [Hospital_A] Loading public key for Hospital_B from 'Hospital_B_public.pem'...
2025-11-10 12:23:57 [INFO] [Hospital_A] PublicKeyLoaded | owner=Hospital_B | source=Hospital_B_public.pem
2025-11-10 12:23:57 [INFO] [Hospital_A] Directories ready: data_dir='hospital_A_data', received_dir='hospital_A_received'
2025-11-10 12:23:57 [INFO] [Hospital_A] Background server thread started.
2025-11-10 12:24:09 [INFO] [Hospital_A] Initializing node with cryptographic material...
2025-11-10 12:24:09 [INFO] [Hospital_A] Loading private key from 'Hospital_A_private.pem'...
2025-11-10 12:24:09 [INFO] [Hospital_A] PrivateKeyLoaded | source=Hospital_A_private.pem
2025-11-10 12:24:09 [INFO] [Hospital_A] Loading public key for Hospital_A from 'Hospital_A_public.pem'...
2025-11-10 12:24:09 [INFO] [Hospital_A] PublicKeyLoaded | owner=Hospital_A | source=Hospital_A_public.pem
2025-11-10 12:24:09 [INFO] [Hospital_A] Loading public key for Hospital_B from 'Hospital_B_public.pem'...
2025-11-10 12:24:09 [INFO] [Hospital_A] PublicKeyLoaded | owner=Hospital_B | source=Hospital_B_public.pem
2025-11-10 12:24:09 [INFO] [Hospital_A] Directories ready: data_dir='hospital_A_data', received_dir='hospital_A_received'
2025-11-10 12:24:09 [INFO] [Hospital_A] Background server thread started.
2025-11-10 12:24:09 [INFO] [Hospital_A] Server listening on 0.0.0.0:65001
2025-11-10 12:24:42 [INFO] [Hospital_A] SignMessage_Start | algo=RSA | hash=SHA-256 | message_preview=Request:patient_123.txt
2025-11-10 12:24:42 [INFO] [Hospital_A] SignMessage_Done | signature_len=256 | signature_preview=3ad7ca10261d80b5201ff82a4c49455c...
2025-11-10 12:24:42 [INFO] [Hospital_A] Connecting to Hospital_B at 127.0.0.1:8002...
2025-11-10 12:24:42 [INFO] [Hospital_A] Sending secure request for 'patient_123.txt' to Hospital_B...
2025-11-10 12:37:14 [INFO] [Hospital_A] Initializing node with cryptographic material...
2025-11-10 12:37:14 [INFO] [Hospital_A] Loading private key from 'Hospital_A_private.pem'...
2025-11-10 12:37:14 [INFO] [Hospital_A] PrivateKeyLoaded | source=Hospital_A_private.pem
2025-11-10 12:37:14 [INFO] [Hospital_A] Loading public key for Hospital_A from 'Hospital_A_public.pem'...
2025-11-10 12:37:14 [INFO] [Hospital_A] PublicKeyLoaded | owner=Hospital_A | source=Hospital_A_public.pem
2025-11-10 12:37:14 [INFO] [Hospital_A] Loading public key for Hospital_B from 'Hospital_B_public.pem'...
2025-11-10 12:37:14 [INFO] [Hospital_A] PublicKeyLoaded | owner=Hospital_B | source=Hospital_B_public.pem
2025-11-10 12:37:14 [INFO] [Hospital_A] Directories ready: data_dir='hospital_A_data', received_dir='hospital_A_received'
2025-11-10 12:37:14 [INFO] [Hospital_A] Background server thread started.
2025-11-10 12:37:14 [INFO] [Hospital_A] Server listening on 0.0.0.0:65001
2025-11-10 12:38:10 [INFO] [Hospital_A] SignMessage_Start | algo=RSA | hash=SHA-256 | message_preview=Request:patient_123.txt
2025-11-10 12:38:10 [INFO] [Hospital_A] SignMessage_Done | signature_len=256 | signature_preview=6aad8ef5e250fe1a20872fa26072a0b1...
2025-11-10 12:38:10 [INFO] [Hospital_A] Connecting to Hospital_B at 127.0.0.1:65002...
2025-11-10 12:38:10 [INFO] [Hospital_A] Sending secure request for 'patient_123.txt'...
2025-11-10 12:38:14 [INFO] [Hospital_A] Encrypted package received, decoding JSON...
2025-11-10 12:38:14 [INFO] [Hospital_A] EncryptedPackage_Received | enc_keys_len=256 | iv_hex=0ae69d1bf5555e9a037690a4004f4305 | ciphertext_len=112 | hmac_len=32 | hmac_preview=caf61ab6749f78fb44824b937d73e8ac...
2025-11-10 12:38:14 [INFO] [Hospital_A] RSA_DecryptKeys_Start | algo=RSA | enc_keys_len=256
2025-11-10 12:38:14 [INFO] [Hospital_A] RSA_DecryptKeys_Done | combined_len=64 | combined_preview=c1496b8d545c61b202f0aeff9fbf1f89...
2025-11-10 12:38:14 [INFO] [Hospital_A] SessionKeys_Derived | aes_key_len=32 | aes_key_preview=c1496b8d545c61b2... | hmac_key_len=32 | hmac_key_preview=660d0e28d39918d7...
2025-11-10 12:38:14 [INFO] [Hospital_A] HMAC_Verify_Start | algo=HMAC-SHA256 | ciphertext_len=112
2025-11-10 12:38:14 [INFO] [Hospital_A] HMAC_Verify_Success | note=Integrity OK
2025-11-10 12:38:14 [INFO] [Hospital_A] AES_Decrypt_Start | algo=AES-256-CBC | ciphertext_len=112 | iv_hex=0ae69d1bf5555e9a037690a4004f4305
2025-11-10 12:38:14 [INFO] [Hospital_A] AES_Decrypt_Done | plaintext_len=103 | plaintext_preview=50415449454e54205245434f52443a20...
2025-11-10 12:38:14 [INFO] [Hospital_A] Decrypted record saved to 'hospital_A_received\RECEIVED_patient_123.txt'
2025-11-10 12:42:51 [INFO] [Hospital_A] Initializing node with cryptographic material...
2025-11-10 12:42:51 [INFO] [Hospital_A] Loading private key from 'Hospital_A_private.pem'...
2025-11-10 12:42:51 [INFO] [Hospital_A] PrivateKeyLoaded | source=Hospital_A_private.pem
2025-11-10 12:42:51 [INFO] [Hospital_A] Loading public key for Hospital_A from 'Hospital_A_public.pem'...
2025-11-10 12:42:51 [INFO] [Hospital_A] PublicKeyLoaded | owner=Hospital_A | source=Hospital_A_public.pem
2025-11-10 12:42:51 [INFO] [Hospital_A] Loading public key for Hospital_B from 'Hospital_B_public.pem'...
2025-11-10 12:42:51 [INFO] [Hospital_A] PublicKeyLoaded | owner=Hospital_B | source=Hospital_B_public.pem
2025-11-10 12:42:51 [INFO] [Hospital_A] Directories ready: data_dir='hospital_A_data', received_dir='hospital_A_received'
2025-11-10 12:42:51 [INFO] [Hospital_A] Background server thread started.
2025-11-10 12:42:51 [INFO] [Hospital_A] Server listening on 0.0.0.0:65001
2025-11-10 12:43:30 [INFO] [Hospital_A] SignMessage_Start | algo=RSA | hash=SHA-256 | message_preview=Request:patient_123.txt
2025-11-10 12:43:30 [INFO] [Hospital_A] SignMessage_Done | signature_len=256 | signature_preview=1f174cffcff72d62ffc8b22dc5513aa0...
2025-11-10 12:43:30 [INFO] [Hospital_A] Connecting to Hospital_B at 127.0.0.1:65002...
2025-11-10 12:43:30 [INFO] [Hospital_A] Sending secure request for 'patient_123.txt'...
2025-11-10 12:43:35 [WARNING] [Hospital_A] Server error response: Request Denied.
2025-11-10 12:43:38 [INFO] [Hospital_A] SignMessage_Start | algo=RSA | hash=SHA-256 | message_preview=Request:patient_123.txt
2025-11-10 12:43:38 [INFO] [Hospital_A] SignMessage_Done | signature_len=256 | signature_preview=2fd7a0dbd279c7c1c13bcb6930ce5b05...
2025-11-10 12:43:38 [INFO] [Hospital_A] Connecting to Hospital_B at 127.0.0.1:65002...
2025-11-10 12:43:38 [INFO] [Hospital_A] Sending secure request for 'patient_123.txt'...
2025-11-10 12:43:43 [INFO] [Hospital_A] Encrypted package received, decoding JSON...
2025-11-10 12:43:43 [INFO] [Hospital_A] EncryptedPackage_Received | enc_keys_len=256 | iv_hex=b430fd87beb9f2be27bf48682b1b41ae | ciphertext_len=112 | hmac_len=32 | hmac_preview=7bec51859aba591c1e27ee14d6063b2f...
2025-11-10 12:43:43 [INFO] [Hospital_A] RSA_DecryptKeys_Start | algo=RSA | enc_keys_len=256
2025-11-10 12:43:43 [INFO] [Hospital_A] RSA_DecryptKeys_Done | combined_len=64 | combined_preview=e2b53196907f9e6445e91a52e9480207...
2025-11-10 12:43:43 [INFO] [Hospital_A] SessionKeys_Derived | aes_key_len=32 | aes_key_preview=e2b53196907f9e64... | hmac_key_len=32 | hmac_key_preview=1e5b9762d413d257...
2025-11-10 12:43:43 [INFO] [Hospital_A] HMAC_Verify_Start | algo=HMAC-SHA256 | ciphertext_len=112
2025-11-10 12:43:43 [INFO] [Hospital_A] HMAC_Verify_Success | note=Integrity OK
2025-11-10 12:43:43 [INFO] [Hospital_A] AES_Decrypt_Start | algo=AES-256-CBC | ciphertext_len=112 | iv_hex=b430fd87beb9f2be27bf48682b1b41ae
2025-11-10 12:43:43 [INFO] [Hospital_A] AES_Decrypt_Done | plaintext_len=103 | plaintext_preview=50415449454e54205245434f52443a20...
2025-11-10 12:43:43 [INFO] [Hospital_A] Decrypted record saved to 'hospital_A_received\RECEIVED_patient_123.txt'
2025-11-10 12:50:51 [INFO] [Hospital_A] Initializing node with cryptographic material...
2025-11-10 12:50:51 [INFO] [Hospital_A] Loading private key from 'Hospital_A_private.pem'...
2025-11-10 12:50:51 [INFO] [Hospital_A] PrivateKeyLoaded | source=Hospital_A_private.pem
2025-11-10 12:50:51 [INFO] [Hospital_A] Loading public key for Hospital_A from 'Hospital_A_public.pem'...
2025-11-10 12:50:51 [INFO] [Hospital_A] PublicKeyLoaded | owner=Hospital_A | source=Hospital_A_public.pem
2025-11-10 12:50:51 [INFO] [Hospital_A] Loading public key for Hospital_B from 'Hospital_B_public.pem'...
2025-11-10 12:50:51 [INFO] [Hospital_A] PublicKeyLoaded | owner=Hospital_B | source=Hospital_B_public.pem
2025-11-10 12:50:51 [INFO] [Hospital_A] Directories ready: data_dir='hospital_A_data', received_dir='hospital_A_received'
2025-11-10 12:50:51 [INFO] [Hospital_A] Background server thread started.
2025-11-10 12:50:51 [INFO] [Hospital_A] Server listening on 0.0.0.0:65001
2025-11-10 12:51:37 [INFO] [Hospital_A] SignMessage_Start | algo=RSA | hash=SHA-256 | message_preview=Request:patient_123.txt
2025-11-10 12:51:37 [INFO] [Hospital_A] SignMessage_Done | signature_len=256 | signature_preview=5a119c8effeafbe8103d867f63513b96...
2025-11-10 12:51:37 [INFO] [Hospital_A] Connecting to Hospital_B at 127.0.0.1:65002...
2025-11-10 12:51:37 [INFO] [Hospital_A] Sending secure request for 'patient_123.txt'...
2025-11-10 12:51:42 [ERROR] [Hospital_A] Connection to 127.0.0.1:65002 timed out.
2025-11-10 12:51:47 [INFO] [Hospital_A] SignMessage_Start | algo=RSA | hash=SHA-256 | message_preview=Request:patient_123.txt
2025-11-10 12:51:47 [INFO] [Hospital_A] SignMessage_Done | signature_len=256 | signature_preview=84f428e3964a9a39efe42835a5c1e683...
2025-11-10 12:51:47 [INFO] [Hospital_A] Connecting to Hospital_B at 127.0.0.1:65002...
2025-11-10 12:51:47 [INFO] [Hospital_A] Sending secure request for 'patient_123.txt'...
2025-11-10 12:51:49 [INFO] [Hospital_A] Encrypted package received, decoding JSON...
2025-11-10 12:51:49 [INFO] [Hospital_A] EncryptedPackage_Received | enc_keys_len=256 | iv_hex=74d4456afbbc1e61edd79e374164e722 | ciphertext_len=112 | hmac_len=32 | hmac_preview=96443d642c882ced979822816ffadd74...
2025-11-10 12:51:49 [INFO] [Hospital_A] RSA_DecryptKeys_Start | algo=RSA | enc_keys_len=256
2025-11-10 12:51:49 [INFO] [Hospital_A] RSA_DecryptKeys_Done | combined_len=64 | combined_preview=7556b5ba47e5c1bcf571bcd6f188a399...
2025-11-10 12:51:49 [INFO] [Hospital_A] SessionKeys_Derived | aes_key_len=32 | aes_key_preview=7556b5ba47e5c1bc... | hmac_key_len=32 | hmac_key_preview=08629d1b92b575bc...
2025-11-10 12:51:49 [INFO] [Hospital_A] HMAC_Verify_Start | algo=HMAC-SHA256 | ciphertext_len=112
2025-11-10 12:51:49 [INFO] [Hospital_A] HMAC_Verify_Success | note=Integrity OK
2025-11-10 12:51:49 [INFO] [Hospital_A] AES_Decrypt_Start | algo=AES-256-CBC | ciphertext_len=112 | iv_hex=74d4456afbbc1e61edd79e374164e722
2025-11-10 12:51:49 [INFO] [Hospital_A] AES_Decrypt_Done | plaintext_len=103 | plaintext_preview=50415449454e54205245434f52443a20...
2025-11-10 12:51:49 [INFO] [Hospital_A] Decrypted record saved to 'hospital_A_received\RECEIVED_patient_123.txt'
2025-11-10 13:02:17 [INFO] [Hospital_A] Initializing node with cryptographic material...
2025-11-10 13:02:17 [INFO] [Hospital_A] Loading private key from 'Hospital_A_private.pem'...
2025-11-10 13:02:17 [INFO] [Hospital_A] PrivateKeyLoaded | source=Hospital_A_private.pem
2025-11-10 13:02:17 [INFO] [Hospital_A] Loading public key for Hospital_A from 'Hospital_A_public.pem'...
2025-11-10 13:02:17 [INFO] [Hospital_A] PublicKeyLoaded | owner=Hospital_A | source=Hospital_A_public.pem
2025-11-10 13:02:17 [INFO] [Hospital_A] Loading public key for Hospital_B from 'Hospital_B_public.pem'...
2025-11-10 13:02:17 [INFO] [Hospital_A] PublicKeyLoaded | owner=Hospital_B | source=Hospital_B_public.pem
2025-11-10 13:02:17 [INFO] [Hospital_A] Directories ready: data_dir='hospital_A_data', received_dir='hospital_A_received'
2025-11-10 13:02:17 [INFO] [Hospital_A] Background server thread started.
2025-11-10 13:02:17 [INFO] [Hospital_A] Server listening on 0.0.0.0:65001
2025-11-10 13:03:04 [INFO] [Hospital_A] SignMessage_Start | algo=RSA | hash=SHA-256 | message_preview=Request:patient_123.txt
2025-11-10 13:03:04 [INFO] [Hospital_A] SignMessage_Done | signature_len=256 | signature_preview=6909b2ae97c7e11f2b34073fa75a2ae9...
2025-11-10 13:03:04 [INFO] [Hospital_A] Connecting to Hospital_B at 127.0.0.1:65002...
2025-11-10 13:03:04 [INFO] [Hospital_A] Sending secure request for 'patient_123.txt'...
2025-11-10 13:03:07 [WARNING] [Hospital_A] Server error response: Request Denied.
2025-11-10 13:03:33 [INFO] [Hospital_A] SignMessage_Start | algo=RSA | hash=SHA-256 | message_preview=Request:patient_123.txt
2025-11-10 13:03:33 [INFO] [Hospital_A] SignMessage_Done | signature_len=256 | signature_preview=2481a81610a6c5f173e934ea9e7bd877...
2025-11-10 13:03:33 [INFO] [Hospital_A] Connecting to Hospital_B at 127.0.0.1:65002...
2025-11-10 13:03:33 [INFO] [Hospital_A] Sending secure request for 'patient_123.txt'...
2025-11-10 13:03:37 [WARNING] [Hospital_A] Server error response: Request Denied.
2025-11-10 13:03:55 [INFO] [Hospital_A] SignMessage_Start | algo=RSA | hash=SHA-256 | message_preview=Request:patient_123.txt
2025-11-10 13:03:55 [INFO] [Hospital_A] SignMessage_Done | signature_len=256 | signature_preview=25dfc7fceec27bea8b49ba610be501d5...
2025-11-10 13:03:55 [INFO] [Hospital_A] Connecting to Hospital_B at 127.0.0.1:65002...
2025-11-10 13:03:55 [INFO] [Hospital_A] Sending secure request for 'patient_123.txt'...
2025-11-10 13:03:58 [INFO] [Hospital_A] Encrypted package received, decoding JSON...
2025-11-10 13:03:58 [INFO] [Hospital_A] EncryptedPackage_Received | enc_keys_len=256 | iv_hex=75e21debb1f7333ca7a2af513da1f8b4 | ciphertext_len=112 | hmac_len=32 | hmac_preview=d1a0312b42a656ca9154203d67b8ce50...
2025-11-10 13:03:58 [INFO] [Hospital_A] RSA_DecryptKeys_Start | algo=RSA | enc_keys_len=256
2025-11-10 13:03:58 [INFO] [Hospital_A] RSA_DecryptKeys_Done | combined_len=64 | combined_preview=b2db73ff6a246833e68855704ec7d4d5...
2025-11-10 13:03:58 [INFO] [Hospital_A] SessionKeys_Derived | aes_key_len=32 | aes_key_preview=b2db73ff6a246833... | hmac_key_len=32 | hmac_key_preview=b62a749e73a6269f...
2025-11-10 13:03:58 [INFO] [Hospital_A] HMAC_Verify_Start | algo=HMAC-SHA256 | ciphertext_len=112
2025-11-10 13:03:58 [INFO] [Hospital_A] HMAC_Verify_Success | note=Integrity OK
2025-11-10 13:03:58 [INFO] [Hospital_A] AES_Decrypt_Start | algo=AES-256-CBC | ciphertext_len=112 | iv_hex=75e21debb1f7333ca7a2af513da1f8b4
2025-11-10 13:03:58 [INFO] [Hospital_A] AES_Decrypt_Done | plaintext_len=103 | plaintext_preview=50415449454e54205245434f52443a20...
2025-11-10 13:03:58 [INFO] [Hospital_A] Decrypted record saved to 'hospital_A_received\RECEIVED_patient_123.txt'
2025-11-10 13:04:28 [INFO] [Hospital_A] SignMessage_Start | algo=RSA | hash=SHA-256 | message_preview=Request:ba7bou7a.txt
2025-11-10 13:04:28 [INFO] [Hospital_A] SignMessage_Done | signature_len=256 | signature_preview=66edb3eb447800f33c47e569be9dbd0e...
2025-11-10 13:04:28 [INFO] [Hospital_A] Connecting to Hospital_B at 127.0.0.1:65002...
2025-11-10 13:04:28 [INFO] [Hospital_A] Sending secure request for 'ba7bou7a.txt'...
2025-11-10 13:04:33 [ERROR] [Hospital_A] Connection to 127.0.0.1:65002 timed out.
2025-11-10 13:05:47 [INFO] [Hospital_A] SignMessage_Start | algo=RSA | hash=SHA-256 | message_preview=Request:ba7bou7a.txt
2025-11-10 13:05:47 [INFO] [Hospital_A] SignMessage_Done | signature_len=256 | signature_preview=01af0f0f0bfca40b0503952a5efd3baa...
2025-11-10 13:05:47 [INFO] [Hospital_A] Connecting to Hospital_B at 127.0.0.1:65002...
2025-11-10 13:05:47 [INFO] [Hospital_A] Sending secure request for 'ba7bou7a.txt'...
2025-11-10 13:05:52 [ERROR] [Hospital_A] Connection to 127.0.0.1:65002 timed out.
2025-11-10 13:06:06 [INFO] [Hospital_A] SignMessage_Start | algo=RSA | hash=SHA-256 | message_preview=Request:ba7bou7a.txt
2025-11-10 13:06:06 [INFO] [Hospital_A] SignMessage_Done | signature_len=256 | signature_preview=1411a175630e33d10bffa3423023e5df...
2025-11-10 13:06:06 [INFO] [Hospital_A] Connecting to Hospital_B at 127.0.0.1:65002...
2025-11-10 13:06:06 [INFO] [Hospital_A] Sending secure request for 'ba7bou7a.txt'...
2025-11-10 13:06:09 [WARNING] [Hospital_A] Server error response: Request Denied.
2025-11-10 13:06:11 [INFO] [Hospital_A] SignMessage_Start | algo=RSA | hash=SHA-256 | message_preview=Request:ba7bou7a.txt
2025-11-10 13:06:11 [INFO] [Hospital_A] SignMessage_Done | signature_len=256 | signature_preview=6d4c1c0568b70ea09c0da215909b3caf...
2025-11-10 13:06:11 [INFO] [Hospital_A] Connecting to Hospital_B at 127.0.0.1:65002...
2025-11-10 13:06:11 [INFO] [Hospital_A] Sending secure request for 'ba7bou7a.txt'...
2025-11-10 13:06:15 [INFO] [Hospital_A] Encrypted package received, decoding JSON...
2025-11-10 13:06:15 [INFO] [Hospital_A] EncryptedPackage_Received | enc_keys_len=256 | iv_hex=362e7a1e6c2530e04f4051ff6988b2f5 | ciphertext_len=16 | hmac_len=32 | hmac_preview=6672938815097a32abf986cb94862537...
2025-11-10 13:06:15 [INFO] [Hospital_A] RSA_DecryptKeys_Start | algo=RSA | enc_keys_len=256
2025-11-10 13:06:15 [INFO] [Hospital_A] RSA_DecryptKeys_Done | combined_len=64 | combined_preview=81c8f068f476a8ff91475cd4215e71ee...
2025-11-10 13:06:15 [INFO] [Hospital_A] SessionKeys_Derived | aes_key_len=32 | aes_key_preview=81c8f068f476a8ff... | hmac_key_len=32 | hmac_key_preview=e454010c96415ea3...
2025-11-10 13:06:15 [INFO] [Hospital_A] HMAC_Verify_Start | algo=HMAC-SHA256 | ciphertext_len=16
2025-11-10 13:06:15 [INFO] [Hospital_A] HMAC_Verify_Success | note=Integrity OK
2025-11-10 13:06:15 [INFO] [Hospital_A] AES_Decrypt_Start | algo=AES-256-CBC | ciphertext_len=16 | iv_hex=362e7a1e6c2530e04f4051ff6988b2f5
2025-11-10 13:06:15 [INFO] [Hospital_A] AES_Decrypt_Done | plaintext_len=6 | plaintext_preview=616c6f6f6f6f
2025-11-10 13:06:15 [INFO] [Hospital_A] Decrypted record saved to 'hospital_A_received\RECEIVED_ba7bou7a.txt'
2025-11-10 13:14:03 [INFO] [Hospital_A] Initializing node with cryptographic material...
2025-11-10 13:14:03 [INFO] [Hospital_A] Loading private key from 'Hospital_A_private.pem'...
2025-11-10 13:14:03 [INFO] [Hospital_A] PrivateKeyLoaded | source=Hospital_A_private.pem
2025-11-10 13:14:03 [INFO] [Hospital_A] Loading public key for Hospital_A from 'Hospital_A_public.pem'...
2025-11-10 13:14:03 [INFO] [Hospital_A] PublicKeyLoaded | owner=Hospital_A | source=Hospital_A_public.pem
2025-11-10 13:14:03 [INFO] [Hospital_A] Loading public key for Hospital_B from 'Hospital_B_public.pem'...
2025-11-10 13:14:03 [INFO] [Hospital_A] PublicKeyLoaded | owner=Hospital_B | source=Hospital_B_public.pem
2025-11-10 13:14:03 [INFO] [Hospital_A] Directories ready: data_dir='hospital_A_data', received_dir='hospital_A_received'
2025-11-10 13:14:03 [INFO] [Hospital_A] Background server thread started.
2025-11-10 13:14:03 [INFO] [Hospital_A] Server listening on 0.0.0.0:65001
2025-11-10 13:15:00 [INFO] [Hospital_A] SignMessage_Start | algo=RSA | hash=SHA-256 | message_preview=Request:patient_123.txt
2025-11-10 13:15:00 [INFO] [Hospital_A] SignMessage_Done | signature_len=256 | signature_preview=4781a694fc73e222036a60970ef8fe3e...
2025-11-10 13:15:00 [INFO] [Hospital_A] Connecting to Hospital_B at 127.0.0.1:65002...
2025-11-10 13:15:00 [INFO] [Hospital_A] Sending secure request for 'patient_123.txt'...
2025-11-10 13:15:05 [ERROR] [Hospital_A] Connection to 127.0.0.1:65002 timed out.
2025-11-10 13:15:29 [INFO] [Hospital_A] SignMessage_Start | algo=RSA | hash=SHA-256 | message_preview=Request:patient_123.txt
2025-11-10 13:15:29 [INFO] [Hospital_A] SignMessage_Done | signature_len=256 | signature_preview=01ad7bc67b8c82a2c3f7b1f71541a394...
2025-11-10 13:15:29 [INFO] [Hospital_A] Connecting to Hospital_B at 127.0.0.1:65002...
2025-11-10 13:15:29 [INFO] [Hospital_A] Sending secure request for 'patient_123.txt'...
2025-11-10 13:15:33 [INFO] [Hospital_A] Encrypted package received, decoding JSON...
2025-11-10 13:15:33 [INFO] [Hospital_A] EncryptedPackage_Received | enc_keys_len=256 | iv_hex=1fd30e6b963d01b78cc13c8b3587a96b | ciphertext_len=112 | hmac_len=32 | hmac_preview=3776d0a39ddb4311f1781a797eb92657...
2025-11-10 13:15:33 [INFO] [Hospital_A] RSA_DecryptKeys_Start | algo=RSA | enc_keys_len=256
2025-11-10 13:15:33 [INFO] [Hospital_A] RSA_DecryptKeys_Done | combined_len=64 | combined_preview=3058f2a224cbdd1b0c46eddb584f292a...
2025-11-10 13:15:33 [INFO] [Hospital_A] SessionKeys_Derived | aes_key_len=32 | aes_key_preview=3058f2a224cbdd1b... | hmac_key_len=32 | hmac_key_preview=a7e5b33a932d186f...
2025-11-10 13:15:33 [INFO] [Hospital_A] HMAC_Verify_Start | algo=HMAC-SHA256 | ciphertext_len=112
2025-11-10 13:15:33 [INFO] [Hospital_A] HMAC_Verify_Success | note=Integrity OK
2025-11-10 13:15:33 [INFO] [Hospital_A] AES_Decrypt_Start | algo=AES-256-CBC | ciphertext_len=112 | iv_hex=1fd30e6b963d01b78cc13c8b3587a96b
2025-11-10 13:15:33 [INFO] [Hospital_A] AES_Decrypt_Done | plaintext_len=103 | plaintext_preview=50415449454e54205245434f52443a20...
2025-11-10 13:15:33 [INFO] [Hospital_A] Decrypted record saved to 'hospital_A_received\RECEIVED_patient_123.txt'
2025-11-10 13:15:41 [INFO] [Hospital_A] SignMessage_Start | algo=RSA | hash=SHA-256 | message_preview=Request:ba7bou7a.txt
2025-11-10 13:15:41 [INFO] [Hospital_A] SignMessage_Done | signature_len=256 | signature_preview=4f7a9dbcf8d6d5d52d55237917475461...
2025-11-10 13:15:41 [INFO] [Hospital_A] Connecting to Hospital_B at 127.0.0.1:65002...
2025-11-10 13:15:41 [INFO] [Hospital_A] Sending secure request for 'ba7bou7a.txt'...
2025-11-10 13:15:44 [WARNING] [Hospital_A] Server error response: Request Denied.
2025-11-10 13:23:29 [INFO] [Hospital_A] Initializing node with cryptographic material...
2025-11-10 13:23:29 [INFO] [Hospital_A] Loading private key from 'Hospital_A_private.pem'...
2025-11-10 13:23:29 [INFO] [Hospital_A] PrivateKeyLoaded | source=Hospital_A_private.pem
2025-11-10 13:23:29 [INFO] [Hospital_A] Loading public key for Hospital_A from 'Hospital_A_public.pem'...
2025-11-10 13:23:29 [INFO] [Hospital_A] PublicKeyLoaded | owner=Hospital_A | source=Hospital_A_public.pem
2025-11-10 13:23:29 [INFO] [Hospital_A] Loading public key for Hospital_B from 'Hospital_B_public.pem'...
2025-11-10 13:23:29 [INFO] [Hospital_A] PublicKeyLoaded | owner=Hospital_B | source=Hospital_B_public.pem
2025-11-10 13:23:29 [INFO] [Hospital_A] Directories ready: data_dir='hospital_A_data', received_dir='hospital_A_received'
2025-11-10 13:23:29 [INFO] [Hospital_A] Background server thread started.
2025-11-10 13:23:29 [INFO] [Hospital_A] Server listening on 0.0.0.0:65001
2025-11-10 13:24:29 [INFO] [Hospital_A] SignMessage_Start | algo=RSA | hash=SHA-256 | message_preview=Request:ba7bou7a.txt
2025-11-10 13:24:29 [INFO] [Hospital_A] SignMessage_Done | signature_len=256 | signature_preview=1b51b21990c3740c956eb9eec106ec3d...
2025-11-10 13:24:29 [INFO] [Hospital_A] Connecting to Hospital_B at 127.0.0.1:65002...
2025-11-10 13:24:29 [INFO] [Hospital_A] Sending secure request for 'ba7bou7a.txt'...
2025-11-10 13:24:34 [ERROR] [Hospital_A] Connection to 127.0.0.1:65002 timed out.
2025-11-10 13:24:38 [INFO] [Hospital_A] SignMessage_Start | algo=RSA | hash=SHA-256 | message_preview=Request:ba7bou7a.txt
2025-11-10 13:24:38 [INFO] [Hospital_A] SignMessage_Done | signature_len=256 | signature_preview=00e766348b65cc878c5e7c757f8705cd...
2025-11-10 13:24:38 [INFO] [Hospital_A] Connecting to Hospital_B at 127.0.0.1:65002...
2025-11-10 13:24:38 [INFO] [Hospital_A] Sending secure request for 'ba7bou7a.txt'...
2025-11-10 13:24:40 [INFO] [Hospital_A] Encrypted package received, decoding JSON...
2025-11-10 13:24:40 [INFO] [Hospital_A] EncryptedPackage_Received | enc_keys_len=256 | iv_hex=3ae5d20216782fecfd2c02add7b2589f | ciphertext_len=16 | hmac_len=32 | hmac_preview=d9ccb34acbabe2637de7aede14df947b...
2025-11-10 13:24:40 [INFO] [Hospital_A] RSA_DecryptKeys_Start | algo=RSA | enc_keys_len=256
2025-11-10 13:24:40 [INFO] [Hospital_A] RSA_DecryptKeys_Done | combined_len=64 | combined_preview=ca6df4fb7887e971dd1d80fbb33947b2...
2025-11-10 13:24:40 [INFO] [Hospital_A] SessionKeys_Derived | aes_key_len=32 | aes_key_preview=ca6df4fb7887e971... | hmac_key_len=32 | hmac_key_preview=4a59b2426cb29635...
2025-11-10 13:24:40 [INFO] [Hospital_A] HMAC_Verify_Start | algo=HMAC-SHA256 | ciphertext_len=16
2025-11-10 13:24:40 [INFO] [Hospital_A] HMAC_Verify_Success | note=Integrity OK
2025-11-10 13:24:40 [INFO] [Hospital_A] AES_Decrypt_Start | algo=AES-256-CBC | ciphertext_len=16 | iv_hex=3ae5d20216782fecfd2c02add7b2589f
2025-11-10 13:24:40 [INFO] [Hospital_A] AES_Decrypt_Done | plaintext_len=6 | plaintext_preview=616c6f6f6f6f
2025-11-10 13:24:40 [INFO] [Hospital_A] Decrypted record saved to 'hospital_A_received\RECEIVED_ba7bou7a.txt'
2025-11-10 13:25:15 [INFO] [Hospital_A] Accepted connection from ('127.0.0.1', 50313)
2025-11-10 13:25:15 [INFO] [Hospital_A] Request_Received | from_hospital=Hospital_B | message_preview=Request:patient_123.txt | signature_len=256 | signature_preview=09a146711c7e90d7c2dbaf7301fef0e3...
2025-11-10 13:25:15 [INFO] [Hospital_A] VerifySignature_Start | algo=RSA | hash=SHA-256
2025-11-10 13:25:15 [INFO] [Hospital_A] VerifySignature_Success | note=Requester authenticated
2025-11-10 13:25:15 [INFO] [Hospital_A] Valid request for 'patient_123.txt' from Hospital_B
2025-11-10 13:25:15 [INFO] [Hospital_A] Approval pending: id=a2377efa-2ba1-439d-91bd-9d77427849c2, from=Hospital_B, file=patient_123.txt
2025-11-10 13:25:15 [DEBUG] [Hospital_A] Waiting for decision: id=a2377efa-2ba1-439d-91bd-9d77427849c2, requester=Hospital_B, file=patient_123.txt
2025-11-10 13:25:15 [INFO] [Hospital_A] Pending approvals count=1
2025-11-10 13:25:16 [INFO] [Hospital_A] Pending approvals count=1
2025-11-10 13:25:17 [INFO] [Hospital_A] Pending approvals count=1
2025-11-10 13:25:17 [INFO] [Hospital_A] Pending approvals count=1
2025-11-10 13:25:18 [INFO] [Hospital_A] Staff APPROVED request_id=a2377efa-2ba1-439d-91bd-9d77427849c2 from=Hospital_B file=patient_123.txt
2025-11-10 13:25:18 [INFO] [Hospital_A] Request a2377efa-2ba1-439d-91bd-9d77427849c2 approved. Encrypting and sending...
2025-11-10 13:25:18 [INFO] [Hospital_A] File_Read | file=patient_123.txt | size=103 | preview=50415449454e54205245434f52443a20...
2025-11-10 13:25:18 [INFO] [Hospital_A] SessionKeys_Generated | aes_key_len=32 | aes_key_preview=bf465d67e2d5b6d5... | hmac_key_len=32 | hmac_key_preview=6e2d654b93115587...
2025-11-10 13:25:18 [INFO] [Hospital_A] AES_Encrypt_Done | iv_hex=c7028230313b4ad4cd88ea293a060547 | plaintext_len=103 | ciphertext_len=112 | ciphertext_preview=9deae808a79b277fa6e282cc60e975eb...
2025-11-10 13:25:18 [INFO] [Hospital_A] HMAC_Generate_Done | tag_len=32 | tag_preview=d0e59fcb5e84283c829cf99abfd360dc...
2025-11-10 13:25:18 [INFO] [Hospital_A] RSA_EncryptKeys_Start | combined_len=64 | combined_preview=bf465d67e2d5b6d56f609d81ef351598...
2025-11-10 13:25:18 [INFO] [Hospital_A] RSA_EncryptKeys_Done | enc_keys_len=256 | enc_keys_preview=16e2c629f04e85303f7406825b5bbee9...
2025-11-10 13:25:18 [INFO] [Hospital_A] Secure package for 'patient_123.txt' sent to Hospital_B.
2025-11-10 13:25:18 [INFO] [Hospital_A] Connection from Hospital_B closed.
2025-11-10 21:13:08 [INFO] [Hospital_A] Initializing node with cryptographic material...
2025-11-10 21:13:08 [INFO] [Hospital_A] Loading private key from 'Hospital_A_private.pem'...
2025-11-10 21:13:08 [INFO] [Hospital_A] PrivateKeyLoaded | source=Hospital_A_private.pem
2025-11-10 21:13:08 [INFO] [Hospital_A] Loading public key for Hospital_A from 'Hospital_A_public.pem'...
2025-11-10 21:13:08 [INFO] [Hospital_A] PublicKeyLoaded | owner=Hospital_A | source=Hospital_A_public.pem
2025-11-10 21:13:08 [INFO] [Hospital_A] Loading public key for Hospital_B from 'Hospital_B_public.pem'...
2025-11-10 21:13:08 [INFO] [Hospital_A] PublicKeyLoaded | owner=Hospital_B | source=Hospital_B_public.pem
2025-11-10 21:13:08 [INFO] [Hospital_A] Directories ready: data_dir='hospital_A_data', received_dir='hospital_A_received'
2025-11-10 21:13:08 [INFO] [Hospital_A] Background server thread started.
2025-11-10 21:13:08 [INFO] [Hospital_A] Server listening on 0.0.0.0:65001
2025-11-10 21:16:35 [INFO] [Hospital_A] SignMessage_Start | algo=RSA | hash=SHA-256 | message_preview=Request:patient_123.txt
2025-11-10 21:16:35 [INFO] [Hospital_A] SignMessage_Done | signature_len=256 | signature_preview=330e5cc93b369e54075adb63e77696e3...
2025-11-10 21:16:35 [INFO] [Hospital_A] Connecting to Hospital_B at 127.0.0.1:65002...
2025-11-10 21:16:35 [INFO] [Hospital_A] Sending secure request for 'patient_123.txt'...
2025-11-10 21:16:40 [ERROR] [Hospital_A] Connection to 127.0.0.1:65002 timed out.
2025-11-10 21:17:29 [INFO] [Hospital_A] SignMessage_Start | algo=RSA | hash=SHA-256 | message_preview=Request:patient_123.txt
2025-11-10 21:17:29 [INFO] [Hospital_A] SignMessage_Done | signature_len=256 | signature_preview=4021d5b18b82a1929b02075e30d64d06...
2025-11-10 21:17:29 [INFO] [Hospital_A] Connecting to Hospital_B at 127.0.0.1:65002...
2025-11-10 21:17:29 [INFO] [Hospital_A] Sending secure request for 'patient_123.txt'...
2025-11-10 21:17:32 [WARNING] [Hospital_A] Server error response: Request Denied.
2025-11-10 21:17:40 [INFO] [Hospital_A] SignMessage_Start | algo=RSA | hash=SHA-256 | message_preview=Request:patient_123.txt
2025-11-10 21:17:40 [INFO] [Hospital_A] SignMessage_Done | signature_len=256 | signature_preview=571e70f00158126e20a47ea0ae6ef1f7...
2025-11-10 21:17:40 [INFO] [Hospital_A] Connecting to Hospital_B at 127.0.0.1:65002...
2025-11-10 21:17:40 [INFO] [Hospital_A] Sending secure request for 'patient_123.txt'...
2025-11-10 21:17:43 [INFO] [Hospital_A] Encrypted package received, decoding JSON...
2025-11-10 21:17:43 [INFO] [Hospital_A] EncryptedPackage_Received | enc_keys_len=256 | iv_hex=4d5cdab5eabc835ca60504bf784d219e | ciphertext_len=112 | hmac_len=32 | hmac_preview=e09b2b8f779656e0dc3978ae0da7426b...
2025-11-10 21:17:43 [INFO] [Hospital_A] RSA_DecryptKeys_Start | algo=RSA | enc_keys_len=256
2025-11-10 21:17:43 [INFO] [Hospital_A] RSA_DecryptKeys_Done | combined_len=64 | combined_preview=70278c7b3fed7dde25981276ffc8cee0...
2025-11-10 21:17:43 [INFO] [Hospital_A] SessionKeys_Derived | aes_key_len=32 | aes_key_preview=70278c7b3fed7dde... | hmac_key_len=32 | hmac_key_preview=432bf457a55bd356...
2025-11-10 21:17:43 [INFO] [Hospital_A] HMAC_Verify_Start | algo=HMAC-SHA256 | ciphertext_len=112
2025-11-10 21:17:43 [INFO] [Hospital_A] HMAC_Verify_Success | note=Integrity OK
2025-11-10 21:17:43 [INFO] [Hospital_A] AES_Decrypt_Start | algo=AES-256-CBC | ciphertext_len=112 | iv_hex=4d5cdab5eabc835ca60504bf784d219e
2025-11-10 21:17:43 [INFO] [Hospital_A] AES_Decrypt_Done | plaintext_len=103 | plaintext_preview=50415449454e54205245434f52443a20...
2025-11-10 21:17:43 [INFO] [Hospital_A] Decrypted record saved to 'hospital_A_received\RECEIVED_patient_123.txt'
2025-11-10 21:36:08 [INFO] [Hospital_A] Initializing node with cryptographic material...
2025-11-10 21:36:08 [INFO] [Hospital_A] Loading private key from 'Hospital_A_private.pem'...
2025-11-10 21:36:08 [INFO] [Hospital_A] PrivateKeyLoaded | source=Hospital_A_private.pem
2025-11-10 21:36:08 [INFO] [Hospital_A] Loading public key for Hospital_A from 'Hospital_A_public.pem'...
2025-11-10 21:36:08 [INFO] [Hospital_A] PublicKeyLoaded | owner=Hospital_A | source=Hospital_A_public.pem
2025-11-10 21:36:08 [INFO] [Hospital_A] Loading public key for Hospital_B from 'Hospital_B_public.pem'...
2025-11-10 21:36:08 [INFO] [Hospital_A] PublicKeyLoaded | owner=Hospital_B | source=Hospital_B_public.pem
2025-11-10 21:36:08 [INFO] [Hospital_A] Directories ready: data_dir='hospital_A_data', received_dir='hospital_A_received'
2025-11-10 21:36:08 [INFO] [Hospital_A] Background server thread started.
2025-11-10 21:36:08 [INFO] [Hospital_A] Server listening on 0.0.0.0:65001
2025-11-10 21:36:39 [INFO] [Hospital_A] SignMessage_Start | algo=RSA | hash=SHA-256 | message_preview=Request:ba7bou7a.txt
2025-11-10 21:36:39 [INFO] [Hospital_A] SignMessage_Done | signature_len=256 | signature_preview=43648aa9b5d3bc0dd4badf3d854bd979...
2025-11-10 21:36:39 [INFO] [Hospital_A] Connecting to Hospital_B at 10.22.237.226:65002...
2025-11-10 21:36:44 [ERROR] [Hospital_A] Connection to 10.22.237.226:65002 timed out.
2025-11-10 21:39:12 [INFO] [Hospital_A] Accepted connection from ('10.222.237.226', 63290)
2025-11-10 21:39:12 [INFO] [Hospital_A] Request_Received | from_hospital=Hospital_B | message_preview=Request:ba7bou7a.txt | signature_len=256 | signature_preview=7171deb525a718e682c77cf8a4650e33...
2025-11-10 21:39:12 [INFO] [Hospital_A] VerifySignature_Start | algo=RSA | hash=SHA-256
2025-11-10 21:39:12 [INFO] [Hospital_A] VerifySignature_Success | note=Requester authenticated
2025-11-10 21:39:12 [WARNING] [Hospital_A] Requested file not found: hospital_A_data\ba7bou7a.txt
2025-11-10 21:39:12 [INFO] [Hospital_A] Connection from Hospital_B closed.
2025-11-10 21:39:13 [INFO] [Hospital_A] Accepted connection from ('10.222.237.226', 63293)
2025-11-10 21:39:13 [INFO] [Hospital_A] Request_Received | from_hospital=Hospital_B | message_preview=Request:ba7bou7a.txt | signature_len=256 | signature_preview=6965748bc0379a14ecff6fc66968819b...
2025-11-10 21:39:13 [INFO] [Hospital_A] VerifySignature_Start | algo=RSA | hash=SHA-256
2025-11-10 21:39:13 [INFO] [Hospital_A] VerifySignature_Success | note=Requester authenticated
2025-11-10 21:39:13 [WARNING] [Hospital_A] Requested file not found: hospital_A_data\ba7bou7a.txt
2025-11-10 21:39:13 [INFO] [Hospital_A] Connection from Hospital_B closed.
2025-11-10 21:39:14 [INFO] [Hospital_A] Accepted connection from ('10.222.237.226', 63294)
2025-11-10 21:39:14 [INFO] [Hospital_A] Request_Received | from_hospital=Hospital_B | message_preview=Request:ba7bou7a.txt | signature_len=256 | signature_preview=94a7c7ea7371163313378821b212909d...
2025-11-10 21:39:14 [INFO] [Hospital_A] VerifySignature_Start | algo=RSA | hash=SHA-256
2025-11-10 21:39:14 [INFO] [Hospital_A] VerifySignature_Success | note=Requester authenticated
2025-11-10 21:39:14 [WARNING] [Hospital_A] Requested file not found: hospital_A_data\ba7bou7a.txt
2025-11-10 21:39:14 [INFO] [Hospital_A] Connection from Hospital_B closed.
2025-11-10 21:39:42 [INFO] [Hospital_A] Initializing node with cryptographic material...
2025-11-10 21:39:42 [INFO] [Hospital_A] Loading private key from 'Hospital_A_private.pem'...
2025-11-10 21:39:42 [INFO] [Hospital_A] PrivateKeyLoaded | source=Hospital_A_private.pem
2025-11-10 21:39:42 [INFO] [Hospital_A] Loading public key for Hospital_A from 'Hospital_A_public.pem'...
2025-11-10 21:39:42 [INFO] [Hospital_A] PublicKeyLoaded | owner=Hospital_A | source=Hospital_A_public.pem
2025-11-10 21:39:42 [INFO] [Hospital_A] Loading public key for Hospital_B from 'Hospital_B_public.pem'...
2025-11-10 21:39:42 [INFO] [Hospital_A] PublicKeyLoaded | owner=Hospital_B | source=Hospital_B_public.pem
2025-11-10 21:39:42 [INFO] [Hospital_A] Directories ready: data_dir='hospital_A_data', received_dir='hospital_A_received'
2025-11-10 21:39:42 [INFO] [Hospital_A] Background server thread started.
2025-11-10 21:39:42 [INFO] [Hospital_A] Server listening on 0.0.0.0:65001
2025-11-10 21:43:40 [INFO] [Hospital_A] SignMessage_Start | algo=RSA | hash=SHA-256 | message_preview=Request:ba7bou7a.txt
2025-11-10 21:43:40 [INFO] [Hospital_A] SignMessage_Done | signature_len=256 | signature_preview=61f19b4a602b829b194de15df31629d3...
2025-11-10 21:43:40 [INFO] [Hospital_A] Connecting to Hospital_B at 26.37.151.85:65002...
2025-11-10 21:43:45 [ERROR] [Hospital_A] Connection to 26.37.151.85:65002 timed out.
2025-11-10 21:43:54 [INFO] [Hospital_A] SignMessage_Start | algo=RSA | hash=SHA-256 | message_preview=Request:ba7bou7a.txt
2025-11-10 21:43:54 [INFO] [Hospital_A] SignMessage_Done | signature_len=256 | signature_preview=498f54f4c7e0c95f4506e5093111094c...
2025-11-10 21:43:54 [INFO] [Hospital_A] Connecting to Hospital_B at 26.37.151.85:65002...
2025-11-10 21:43:59 [ERROR] [Hospital_A] Connection to 26.37.151.85:65002 timed out.
2025-11-10 21:46:25 [INFO] [Hospital_A] Accepted connection from ('26.37.151.85', 55575)
2025-11-10 21:46:25 [INFO] [Hospital_A] Request_Received | from_hospital=Hospital_B | message_preview=Request:ba7bou7a.txt | signature_len=256 | signature_preview=8d775f8e92f137ab547a5f2e0c978e81...
2025-11-10 21:46:25 [INFO] [Hospital_A] VerifySignature_Start | algo=RSA | hash=SHA-256
2025-11-10 21:46:25 [INFO] [Hospital_A] VerifySignature_Success | note=Requester authenticated
2025-11-10 21:46:25 [WARNING] [Hospital_A] Requested file not found: hospital_A_data\ba7bou7a.txt
2025-11-10 21:46:25 [INFO] [Hospital_A] Connection from Hospital_B closed.
2025-11-10 21:50:14 [INFO] [Hospital_A] Accepted connection from ('26.37.151.85', 53385)
2025-11-10 21:50:14 [INFO] [Hospital_A] Request_Received | from_hospital=Hospital_B | message_preview=Request:assoumaBa7.txt | signature_len=256 | signature_preview=873a736fecc3a0fe2a1606d3d9c62181...
2025-11-10 21:50:14 [INFO] [Hospital_A] VerifySignature_Start | algo=RSA | hash=SHA-256
2025-11-10 21:50:14 [INFO] [Hospital_A] VerifySignature_Success | note=Requester authenticated
2025-11-10 21:50:14 [WARNING] [Hospital_A] Requested file not found: hospital_A_data\assoumaBa7.txt
2025-11-10 21:50:14 [INFO] [Hospital_A] Connection from Hospital_B closed.
2025-11-10 21:50:37 [INFO] [Hospital_A] Accepted connection from ('26.37.151.85', 60252)
2025-11-10 21:50:37 [INFO] [Hospital_A] Request_Received | from_hospital=Hospital_B | message_preview=Request:kassoumaBa7.txt | signature_len=256 | signature_preview=7a014f4d385b7e3a675f7c90b682a6e9...
2025-11-10 21:50:37 [INFO] [Hospital_A] VerifySignature_Start | algo=RSA | hash=SHA-256
2025-11-10 21:50:37 [INFO] [Hospital_A] VerifySignature_Success | note=Requester authenticated
2025-11-10 21:50:37 [INFO] [Hospital_A] Valid request for 'kassoumaBa7.txt' from Hospital_B
2025-11-10 21:50:37 [INFO] [Hospital_A] Approval pending: id=f2156567-c0b0-4156-ae58-cd9fa7e74e91, from=Hospital_B, file=kassoumaBa7.txt
2025-11-10 21:50:37 [DEBUG] [Hospital_A] Waiting for decision: id=f2156567-c0b0-4156-ae58-cd9fa7e74e91, requester=Hospital_B, file=kassoumaBa7.txt
2025-11-10 21:50:37 [INFO] [Hospital_A] Pending approvals count=1
2025-11-10 21:50:38 [INFO] [Hospital_A] Pending approvals count=1
2025-11-10 21:50:39 [INFO] [Hospital_A] Pending approvals count=1
2025-11-10 21:50:40 [INFO] [Hospital_A] Pending approvals count=1
2025-11-10 21:50:41 [INFO] [Hospital_A] Pending approvals count=1
2025-11-10 21:50:42 [INFO] [Hospital_A] Pending approvals count=1
2025-11-10 21:50:43 [INFO] [Hospital_A] Pending approvals count=1
2025-11-10 21:50:44 [INFO] [Hospital_A] Pending approvals count=1
2025-11-10 21:50:45 [INFO] [Hospital_A] Pending approvals count=1
2025-11-10 21:50:45 [INFO] [Hospital_A] Pending approvals count=1
2025-11-10 21:50:46 [INFO] [Hospital_A] Pending approvals count=1
2025-11-10 21:50:47 [INFO] [Hospital_A] Pending approvals count=1
2025-11-10 21:50:48 [INFO] [Hospital_A] Pending approvals count=1
2025-11-10 21:50:48 [INFO] [Hospital_A] Pending approvals count=1
2025-11-10 21:50:48 [INFO] [Hospital_A] Accepted connection from ('26.37.151.85', 60253)
2025-11-10 21:50:48 [INFO] [Hospital_A] Request_Received | from_hospital=Hospital_B | message_preview=Request:kassoumaBa7.txt | signature_len=256 | signature_preview=67e2cf350ac4e9b21170b18a2a324cdd...
2025-11-10 21:50:48 [INFO] [Hospital_A] VerifySignature_Start | algo=RSA | hash=SHA-256
2025-11-10 21:50:48 [INFO] [Hospital_A] VerifySignature_Success | note=Requester authenticated
2025-11-10 21:50:48 [INFO] [Hospital_A] Valid request for 'kassoumaBa7.txt' from Hospital_B
2025-11-10 21:50:48 [INFO] [Hospital_A] Approval pending: id=b73d1525-371f-4f38-8d60-7c11a607874b, from=Hospital_B, file=kassoumaBa7.txt
2025-11-10 21:50:48 [DEBUG] [Hospital_A] Waiting for decision: id=b73d1525-371f-4f38-8d60-7c11a607874b, requester=Hospital_B, file=kassoumaBa7.txt
2025-11-10 21:50:48 [INFO] [Hospital_A] Pending approvals count=2
2025-11-10 21:50:49 [INFO] [Hospital_A] Pending approvals count=2
2025-11-10 21:50:49 [INFO] [Hospital_A] Pending approvals count=2
2025-11-10 21:50:50 [INFO] [Hospital_A] Staff APPROVED request_id=f2156567-c0b0-4156-ae58-cd9fa7e74e91 from=Hospital_B file=kassoumaBa7.txt
2025-11-10 21:50:50 [INFO] [Hospital_A] Request f2156567-c0b0-4156-ae58-cd9fa7e74e91 approved. Encrypting and sending...
2025-11-10 21:50:50 [INFO] [Hospital_A] File_Read | file=kassoumaBa7.txt | size=2 | preview=6869
2025-11-10 21:50:50 [INFO] [Hospital_A] SessionKeys_Generated | aes_key_len=32 | aes_key_preview=2eec967166c64a16... | hmac_key_len=32 | hmac_key_preview=49dd90fdfe76e454...
2025-11-10 21:50:50 [INFO] [Hospital_A] Pending approvals count=1
2025-11-10 21:50:50 [INFO] [Hospital_A] AES_Encrypt_Done | iv_hex=facd5fbed766146aad2eb4657bfdcd13 | plaintext_len=2 | ciphertext_len=16 | ciphertext_preview=f7b8a610e508adb4f761b2eb83fc740a
2025-11-10 21:50:50 [INFO] [Hospital_A] HMAC_Generate_Done | tag_len=32 | tag_preview=9f188f78daf03225d140a8162aeed1c3...
2025-11-10 21:50:50 [INFO] [Hospital_A] RSA_EncryptKeys_Start | combined_len=64 | combined_preview=2eec967166c64a16f89e1bbfedc6919e...
2025-11-10 21:50:50 [INFO] [Hospital_A] RSA_EncryptKeys_Done | enc_keys_len=256 | enc_keys_preview=8311135b2eb5b9671effcb1e9359a916...
2025-11-10 21:50:50 [INFO] [Hospital_A] Secure package for 'kassoumaBa7.txt' sent to Hospital_B.
2025-11-10 21:50:50 [INFO] [Hospital_A] Connection from Hospital_B closed.
2025-11-10 21:50:50 [INFO] [Hospital_A] Pending approvals count=1
2025-11-10 21:50:51 [INFO] [Hospital_A] Pending approvals count=1
2025-11-10 21:50:52 [INFO] [Hospital_A] Pending approvals count=1
2025-11-10 21:50:53 [INFO] [Hospital_A] Pending approvals count=1
2025-11-10 21:50:53 [INFO] [Hospital_A] Pending approvals count=1
2025-11-10 21:50:54 [INFO] [Hospital_A] Pending approvals count=1
2025-11-10 21:50:55 [INFO] [Hospital_A] Pending approvals count=1
2025-11-10 21:50:56 [INFO] [Hospital_A] Pending approvals count=1
2025-11-10 21:50:57 [INFO] [Hospital_A] Pending approvals count=1
2025-11-10 21:50:57 [INFO] [Hospital_A] Pending approvals count=1
2025-11-10 21:50:58 [INFO] [Hospital_A] Pending approvals count=1
2025-11-10 21:50:58 [INFO] [Hospital_A] Pending approvals count=1
2025-11-10 21:50:59 [INFO] [Hospital_A] Pending approvals count=1
2025-11-10 21:51:00 [INFO] [Hospital_A] Pending approvals count=1
2025-11-10 21:51:01 [INFO] [Hospital_A] Pending approvals count=1
2025-11-10 21:51:01 [INFO] [Hospital_A] Pending approvals count=1
2025-11-10 21:51:02 [INFO] [Hospital_A] Pending approvals count=1
2025-11-10 21:51:02 [INFO] [Hospital_A] Pending approvals count=1
2025-11-10 21:51:02 [INFO] [Hospital_A] Accepted connection from ('26.37.151.85', 57458)
2025-11-10 21:51:02 [INFO] [Hospital_A] Request_Received | from_hospital=Hospital_B | message_preview=Request:kassoumaBa7.txt | signature_len=256 | signature_preview=8f0223c64c3b5b49d3d0364962dd0eb6...
2025-11-10 21:51:02 [INFO] [Hospital_A] VerifySignature_Start | algo=RSA | hash=SHA-256
2025-11-10 21:51:02 [INFO] [Hospital_A] VerifySignature_Success | note=Requester authenticated
2025-11-10 21:51:02 [INFO] [Hospital_A] Valid request for 'kassoumaBa7.txt' from Hospital_B
2025-11-10 21:51:02 [INFO] [Hospital_A] Approval pending: id=3f499ad7-2577-4fb9-b334-e27a256a3c76, from=Hospital_B, file=kassoumaBa7.txt
2025-11-10 21:51:02 [DEBUG] [Hospital_A] Waiting for decision: id=3f499ad7-2577-4fb9-b334-e27a256a3c76, requester=Hospital_B, file=kassoumaBa7.txt
2025-11-10 21:51:03 [INFO] [Hospital_A] Pending approvals count=2
2025-11-10 21:51:04 [INFO] [Hospital_A] Pending approvals count=2
2025-11-10 21:51:05 [INFO] [Hospital_A] Pending approvals count=2
2025-11-10 21:51:05 [INFO] [Hospital_A] Staff APPROVED request_id=b73d1525-371f-4f38-8d60-7c11a607874b from=Hospital_B file=kassoumaBa7.txt
2025-11-10 21:51:05 [INFO] [Hospital_A] Request b73d1525-371f-4f38-8d60-7c11a607874b approved. Encrypting and sending...
2025-11-10 21:51:05 [INFO] [Hospital_A] File_Read | file=kassoumaBa7.txt | size=2 | preview=6869
2025-11-10 21:51:05 [INFO] [Hospital_A] SessionKeys_Generated | aes_key_len=32 | aes_key_preview=9a668432ea4067a2... | hmac_key_len=32 | hmac_key_preview=25b7190bbabc012f...
2025-11-10 21:51:05 [INFO] [Hospital_A] AES_Encrypt_Done | iv_hex=061adb8e9aef3fa98daee2d7826ee3d1 | plaintext_len=2 | ciphertext_len=16 | ciphertext_preview=11660744da0ba8e21da4171e24b4df1d
2025-11-10 21:51:05 [INFO] [Hospital_A] HMAC_Generate_Done | tag_len=32 | tag_preview=80050f5cd8484999c8edfb79d70a677d...
2025-11-10 21:51:05 [INFO] [Hospital_A] RSA_EncryptKeys_Start | combined_len=64 | combined_preview=9a668432ea4067a22c2e01cb57b6a7c0...
2025-11-10 21:51:05 [INFO] [Hospital_A] Pending approvals count=1
2025-11-10 21:51:05 [INFO] [Hospital_A] RSA_EncryptKeys_Done | enc_keys_len=256 | enc_keys_preview=0d289b4aec14760217991b1f8aad6c25...
2025-11-10 21:51:05 [INFO] [Hospital_A] Secure package for 'kassoumaBa7.txt' sent to Hospital_B.
2025-11-10 21:51:05 [INFO] [Hospital_A] Connection from Hospital_B closed.
2025-11-10 21:51:05 [INFO] [Hospital_A] Pending approvals count=1
2025-11-10 21:51:06 [INFO] [Hospital_A] Staff APPROVED request_id=3f499ad7-2577-4fb9-b334-e27a256a3c76 from=Hospital_B file=kassoumaBa7.txt
2025-11-10 21:51:06 [INFO] [Hospital_A] Request 3f499ad7-2577-4fb9-b334-e27a256a3c76 approved. Encrypting and sending...
2025-11-10 21:51:06 [INFO] [Hospital_A] File_Read | file=kassoumaBa7.txt | size=2 | preview=6869
2025-11-10 21:51:06 [INFO] [Hospital_A] SessionKeys_Generated | aes_key_len=32 | aes_key_preview=7d469383156d543c... | hmac_key_len=32 | hmac_key_preview=cd63f1137a2fb160...
2025-11-10 21:51:06 [INFO] [Hospital_A] AES_Encrypt_Done | iv_hex=8879729bd0d012b0072ea5d708fc1a3c | plaintext_len=2 | ciphertext_len=16 | ciphertext_preview=491d9973ea3c7d7ea395a10d5ab0dac9
2025-11-10 21:51:06 [INFO] [Hospital_A] HMAC_Generate_Done | tag_len=32 | tag_preview=af900fd203f0c43b3cf1a1e7be22d288...
2025-11-10 21:51:06 [INFO] [Hospital_A] RSA_EncryptKeys_Start | combined_len=64 | combined_preview=7d469383156d543c9cad1465e72c17cc...
2025-11-10 21:51:06 [INFO] [Hospital_A] RSA_EncryptKeys_Done | enc_keys_len=256 | enc_keys_preview=83f057a8fcb1d55b095f62c7cd3096c3...
2025-11-10 21:51:06 [INFO] [Hospital_A] Secure package for 'kassoumaBa7.txt' sent to Hospital_B.
2025-11-10 21:51:06 [INFO] [Hospital_A] Connection from Hospital_B closed.
2025-11-10 21:52:47 [INFO] [Hospital_A] Accepted connection from ('26.37.151.85', 58221)
2025-11-10 21:52:47 [INFO] [Hospital_A] Request_Received | from_hospital=Hospital_B | message_preview=Request:kassoumaBa7.txt | signature_len=256 | signature_preview=7b3f07ef80e7a4069843b742401f62ff...
2025-11-10 21:52:47 [INFO] [Hospital_A] VerifySignature_Start | algo=RSA | hash=SHA-256
2025-11-10 21:52:47 [INFO] [Hospital_A] VerifySignature_Success | note=Requester authenticated
2025-11-10 21:52:47 [INFO] [Hospital_A] Valid request for 'kassoumaBa7.txt' from Hospital_B
2025-11-10 21:52:47 [INFO] [Hospital_A] Approval pending: id=5a229d34-8e2e-49f4-bb81-cee518441435, from=Hospital_B, file=kassoumaBa7.txt
2025-11-10 21:52:47 [DEBUG] [Hospital_A] Waiting for decision: id=5a229d34-8e2e-49f4-bb81-cee518441435, requester=Hospital_B, file=kassoumaBa7.txt
2025-11-10 21:52:48 [INFO] [Hospital_A] Pending approvals count=1
2025-11-10 21:52:49 [INFO] [Hospital_A] Pending approvals count=1
2025-11-10 21:52:49 [INFO] [Hospital_A] Pending approvals count=1
2025-11-10 21:52:50 [INFO] [Hospital_A] Pending approvals count=1
2025-11-10 21:52:51 [INFO] [Hospital_A] Staff APPROVED request_id=5a229d34-8e2e-49f4-bb81-cee518441435 from=Hospital_B file=kassoumaBa7.txt
2025-11-10 21:52:51 [INFO] [Hospital_A] Request 5a229d34-8e2e-49f4-bb81-cee518441435 approved. Encrypting and sending...
2025-11-10 21:52:51 [INFO] [Hospital_A] File_Read | file=kassoumaBa7.txt | size=2 | preview=6869
2025-11-10 21:52:51 [INFO] [Hospital_A] SessionKeys_Generated | aes_key_len=32 | aes_key_preview=e2f1e3eb93b1e085... | hmac_key_len=32 | hmac_key_preview=8dd5abc8c9a052e6...
2025-11-10 21:52:51 [INFO] [Hospital_A] AES_Encrypt_Done | iv_hex=eeb4f014c1ad534cb68fb1da4b7300df | plaintext_len=2 | ciphertext_len=16 | ciphertext_preview=755a6dc6c9a0e06d68ceaf49f76b1889
2025-11-10 21:52:51 [INFO] [Hospital_A] HMAC_Generate_Done | tag_len=32 | tag_preview=d1b1d724707e2ef33ec9be6c9cd9ecda...
2025-11-10 21:52:51 [INFO] [Hospital_A] RSA_EncryptKeys_Start | combined_len=64 | combined_preview=e2f1e3eb93b1e085d80be8fdff27b32a...
2025-11-10 21:52:51 [INFO] [Hospital_A] RSA_EncryptKeys_Done | enc_keys_len=256 | enc_keys_preview=95ece3ea0efb986178a58cd2fbdec274...
2025-11-10 21:52:51 [INFO] [Hospital_A] Secure package for 'kassoumaBa7.txt' sent to Hospital_B.
2025-11-10 21:52:51 [INFO] [Hospital_A] Connection from Hospital_B closed.
2025-11-10 21:52:59 [INFO] [Hospital_A] SignMessage_Start | algo=RSA | hash=SHA-256 | message_preview=Request:ba7bou7a.txt
2025-11-10 21:52:59 [INFO] [Hospital_A] SignMessage_Done | signature_len=256 | signature_preview=261ff6b782d9a35d461fc4a47f86ce9f...
2025-11-10 21:52:59 [INFO] [Hospital_A] Connecting to Hospital_B at 26.37.151.85:65002...
2025-11-10 21:52:59 [INFO] [Hospital_A] Sending secure request for 'ba7bou7a.txt'...
2025-11-10 21:53:02 [INFO] [Hospital_A] Encrypted package received, decoding JSON...
2025-11-10 21:53:02 [INFO] [Hospital_A] EncryptedPackage_Received | enc_keys_len=256 | iv_hex=41af2d08977c9fce06157bb445fdf59d | ciphertext_len=16 | hmac_len=32 | hmac_preview=4c0fbaef8a477da3af2eac101166fa94...
2025-11-10 21:53:02 [INFO] [Hospital_A] RSA_DecryptKeys_Start | algo=RSA | enc_keys_len=256
2025-11-10 21:53:02 [INFO] [Hospital_A] RSA_DecryptKeys_Done | combined_len=64 | combined_preview=b3bf226058dfeb750f1e959a1546f7d9...
2025-11-10 21:53:02 [INFO] [Hospital_A] SessionKeys_Derived | aes_key_len=32 | aes_key_preview=b3bf226058dfeb75... | hmac_key_len=32 | hmac_key_preview=39841b79f0180a6f...
2025-11-10 21:53:02 [INFO] [Hospital_A] HMAC_Verify_Start | algo=HMAC-SHA256 | ciphertext_len=16
2025-11-10 21:53:02 [INFO] [Hospital_A] HMAC_Verify_Success | note=Integrity OK
2025-11-10 21:53:02 [INFO] [Hospital_A] AES_Decrypt_Start | algo=AES-256-CBC | ciphertext_len=16 | iv_hex=41af2d08977c9fce06157bb445fdf59d
2025-11-10 21:53:02 [INFO] [Hospital_A] AES_Decrypt_Done | plaintext_len=6 | plaintext_preview=616c6f6f6f6f
2025-11-10 21:53:02 [INFO] [Hospital_A] Decrypted record saved to 'hospital_A_received\RECEIVED_ba7bou7a.txt'
2025-11-10 21:59:46 [INFO] [Hospital_A] Initializing node with cryptographic material...
2025-11-10 21:59:46 [INFO] [Hospital_A] Loading private key from 'Hospital_A_private.pem'...
2025-11-10 21:59:46 [INFO] [Hospital_A] PrivateKeyLoaded | source=Hospital_A_private.pem
2025-11-10 21:59:46 [INFO] [Hospital_A] Loading public key for Hospital_A from 'Hospital_A_public.pem'...
2025-11-10 21:59:46 [INFO] [Hospital_A] PublicKeyLoaded | owner=Hospital_A | source=Hospital_A_public.pem
2025-11-10 21:59:46 [INFO] [Hospital_A] Loading public key for Hospital_B from 'Hospital_B_public.pem'...
2025-11-10 21:59:46 [INFO] [Hospital_A] PublicKeyLoaded | owner=Hospital_B | source=Hospital_B_public.pem
2025-11-10 21:59:46 [INFO] [Hospital_A] Directories ready: data_dir='hospital_A_data', received_dir='hospital_A_received'
2025-11-10 21:59:46 [INFO] [Hospital_A] Background server thread started.
2025-11-10 21:59:46 [INFO] [Hospital_A] Server listening on 0.0.0.0:65001
2025-11-16 19:44:49 [INFO] [Hospital_A] Initializing node with cryptographic material...
2025-11-16 19:44:49 [INFO] [Hospital_A] Loading private key from 'Hospital_A_private.pem'...
2025-11-16 19:44:49 [INFO] [Hospital_A] PrivateKeyLoaded | source=Hospital_A_private.pem
2025-11-16 19:44:49 [INFO] [Hospital_A] Loading public key for Hospital_A from 'Hospital_A_public.pem'...
2025-11-16 19:44:49 [INFO] [Hospital_A] PublicKeyLoaded | owner=Hospital_A | source=Hospital_A_public.pem
2025-11-16 19:44:49 [INFO] [Hospital_A] Loading public key for Hospital_B from 'Hospital_B_public.pem'...
2025-11-16 19:44:49 [INFO] [Hospital_A] PublicKeyLoaded | owner=Hospital_B | source=Hospital_B_public.pem
2025-11-16 19:44:49 [INFO] [Hospital_A] Directories ready: data_dir='hospital_A_data', received_dir='hospital_A_received'
2025-11-16 19:44:49 [INFO] [Hospital_A] Background server thread started.
2025-11-16 19:44:49 [INFO] [Hospital_A] Server listening on 0.0.0.0:65001
2025-11-16 20:04:41 [INFO] [Hospital_A] Initializing node with cryptographic material...
2025-11-16 20:04:41 [INFO] [Hospital_A] Loading private key from 'Hospital_A_private.pem'...
2025-11-16 20:04:41 [INFO] [Hospital_A] PrivateKeyLoaded | source=Hospital_A_private.pem
2025-11-16 20:04:41 [INFO] [Hospital_A] Loading public key for Hospital_A from 'Hospital_A_public.pem'...
2025-11-16 20:04:41 [INFO] [Hospital_A] PublicKeyLoaded | owner=Hospital_A | source=Hospital_A_public.pem
2025-11-16 20:04:41 [INFO] [Hospital_A] Loading public key for Hospital_B from 'Hospital_B_public.pem'...
2025-11-16 20:04:41 [INFO] [Hospital_A] PublicKeyLoaded | owner=Hospital_B | source=Hospital_B_public.pem
2025-11-16 20:04:41 [INFO] [Hospital_A] Directories ready: data_dir='hospital_A_data', received_dir='hospital_A_received'
2025-11-16 20:04:42 [INFO] [Hospital_A] Registry updated for Hospital_A: host=0.0.0.0, port=65001
2025-11-16 20:04:42 [INFO] [Hospital_A] Background server thread started.
2025-11-16 20:04:42 [INFO] [Hospital_A] Server listening on 0.0.0.0:65001
2025-11-16 21:08:28 [INFO] [Hospital_A] Initializing node with cryptographic material...
2025-11-16 21:08:28 [INFO] [Hospital_A] Loading private key from 'Hospital_A_private.pem'...
2025-11-16 21:08:28 [INFO] [Hospital_A] PrivateKeyLoaded | source=Hospital_A_private.pem
2025-11-16 21:08:28 [INFO] [Hospital_A] Loading public key from 'Hospital_A_public.pem'...
2025-11-16 21:08:28 [INFO] [Hospital_A] PublicKeyLoaded | owner=Hospital_A | source=Hospital_A_public.pem
2025-11-16 21:08:28 [INFO] [Hospital_A] Directories ready: data_dir='Hospital_A_data', received_dir='Hospital_A_received'
2025-11-16 21:08:28 [ERROR] [Hospital_A] Failed to register hospital in registry (name=Hospital_A): register_hospital() got an unexpected keyword argument 'public_key_pem'
Traceback (most recent call last):
  File "D:\Users\Tarek\Desktop\crypto project\kassouma\Crypto\hospital_node.py", line 771, in __init__
    register_hospital(
    ~~~~~~~~~~~~~~~~~^
        name=self.name,
        ^^^^^^^^^^^^^^^
    ...<2 lines>...
        public_key_pem=pub_pem,
        ^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
TypeError: register_hospital() got an unexpected keyword argument 'public_key_pem'
2025-11-16 21:08:28 [INFO] [Hospital_A] Background server thread started.
2025-11-16 21:08:47 [INFO] [Hospital_A] Initializing node with cryptographic material...
2025-11-16 21:08:47 [INFO] [Hospital_A] Loading private key from 'Hospital_A_private.pem'...
2025-11-16 21:08:47 [INFO] [Hospital_A] PrivateKeyLoaded | source=Hospital_A_private.pem
2025-11-16 21:08:47 [INFO] [Hospital_A] Loading public key from 'Hospital_A_public.pem'...
2025-11-16 21:08:47 [INFO] [Hospital_A] PublicKeyLoaded | owner=Hospital_A | source=Hospital_A_public.pem
2025-11-16 21:08:47 [INFO] [Hospital_A] Directories ready: data_dir='Hospital_A_data', received_dir='Hospital_A_received'
2025-11-16 21:08:47 [ERROR] [Hospital_A] Failed to register hospital in registry (name=Hospital_A): register_hospital() got an unexpected keyword argument 'public_key_pem'
Traceback (most recent call last):
  File "D:\Users\Tarek\Desktop\crypto project\kassouma\Crypto\hospital_node.py", line 771, in __init__
    register_hospital(
    ~~~~~~~~~~~~~~~~~^
        name=self.name,
        ^^^^^^^^^^^^^^^
    ...<2 lines>...
        public_key_pem=pub_pem,
        ^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
TypeError: register_hospital() got an unexpected keyword argument 'public_key_pem'
2025-11-16 21:08:47 [INFO] [Hospital_A] Background server thread started.
2025-11-16 21:08:47 [INFO] [Hospital_A] Server listening on 127.0.0.1:65001
2025-11-16 21:15:15 [INFO] [Hospital_A] Initializing node with cryptographic material...
2025-11-16 21:15:15 [INFO] [Hospital_A] Loading private key from 'Hospital_A_private.pem'...
2025-11-16 21:15:16 [INFO] [Hospital_A] PrivateKeyLoaded | source=Hospital_A_private.pem
2025-11-16 21:15:16 [INFO] [Hospital_A] Loading public key from 'Hospital_A_public.pem'...
2025-11-16 21:15:16 [INFO] [Hospital_A] PublicKeyLoaded | owner=Hospital_A | source=Hospital_A_public.pem
2025-11-16 21:15:16 [INFO] [Hospital_A] Directories ready: data_dir='Hospital_A_data', received_dir='Hospital_A_received'
2025-11-16 21:15:47 [INFO] [Hospital_A] Initializing node with cryptographic material...
2025-11-16 21:15:47 [INFO] [Hospital_A] Loading private key from 'Hospital_A_private.pem'...
2025-11-16 21:15:47 [INFO] [Hospital_A] PrivateKeyLoaded | source=Hospital_A_private.pem
2025-11-16 21:15:47 [INFO] [Hospital_A] Loading public key from 'Hospital_A_public.pem'...
2025-11-16 21:15:47 [INFO] [Hospital_A] PublicKeyLoaded | owner=Hospital_A | source=Hospital_A_public.pem
2025-11-16 21:15:47 [INFO] [Hospital_A] Directories ready: data_dir='Hospital_A_data', received_dir='Hospital_A_received'
2025-11-16 21:16:17 [ERROR] [Hospital_A] Failed to register hospital in registry (name=Hospital_A): localhost:27017: [WinError 10061] No connection could be made because the target machine actively refused it (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 691a8553c7eb86ce5bd32119, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('localhost:27017: [WinError 10061] No connection could be made because the target machine actively refused it (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
Traceback (most recent call last):
  File "D:\Users\Tarek\Desktop\crypto project\kassouma\Crypto\hospital_node.py", line 771, in __init__
    register_hospital(
    ~~~~~~~~~~~~~~~~~^
        name=self.name,
        ^^^^^^^^^^^^^^^
    ...<2 lines>...
        public_key_pem=pub_pem,
        ^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\Users\Tarek\Desktop\crypto project\kassouma\Crypto\registry.py", line 37, in register_hospital
    hospitals_col.update_one({"name": name}, {"$set": doc}, upsert=True)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Users\Tarek\Desktop\crypto project\kassouma\Crypto\.venv\Lib\site-packages\pymongo\synchronous\collection.py", line 1336, in update_one
    self._update_retryable(
    ~~~~~~~~~~~~~~~~~~~~~~^
        filter,
        ^^^^^^^
    ...<11 lines>...
        comment=comment,
        ^^^^^^^^^^^^^^^^
    ),
    ^
  File "D:\Users\Tarek\Desktop\crypto project\kassouma\Crypto\.venv\Lib\site-packages\pymongo\synchronous\collection.py", line 1118, in _update_retryable
    return self._database.client._retryable_write(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        (write_concern or self.write_concern).acknowledged and not multi,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
        operation,
        ^^^^^^^^^^
    )
    ^
  File "D:\Users\Tarek\Desktop\crypto project\kassouma\Crypto\.venv\Lib\site-packages\pymongo\synchronous\mongo_client.py", line 2082, in _retryable_write
    return self._retry_with_session(retryable, func, s, bulk, operation, operation_id)
           ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Users\Tarek\Desktop\crypto project\kassouma\Crypto\.venv\Lib\site-packages\pymongo\synchronous\mongo_client.py", line 1968, in _retry_with_session
    return self._retry_internal(
           ~~~~~~~~~~~~~~~~~~~~^
        func=func,
        ^^^^^^^^^^
    ...<4 lines>...
        operation_id=operation_id,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\Users\Tarek\Desktop\crypto project\kassouma\Crypto\.venv\Lib\site-packages\pymongo\_csot.py", line 125, in csot_wrapper
    return func(self, *args, **kwargs)
  File "D:\Users\Tarek\Desktop\crypto project\kassouma\Crypto\.venv\Lib\site-packages\pymongo\synchronous\mongo_client.py", line 2014, in _retry_internal
    ).run()
      ~~~^^
  File "D:\Users\Tarek\Desktop\crypto project\kassouma\Crypto\.venv\Lib\site-packages\pymongo\synchronous\mongo_client.py", line 2765, in run
    return self._read() if self._is_read else self._write()
                                              ~~~~~~~~~~~^^
  File "D:\Users\Tarek\Desktop\crypto project\kassouma\Crypto\.venv\Lib\site-packages\pymongo\synchronous\mongo_client.py", line 2875, in _write
    self._server = self._get_server()
                   ~~~~~~~~~~~~~~~~^^
  File "D:\Users\Tarek\Desktop\crypto project\kassouma\Crypto\.venv\Lib\site-packages\pymongo\synchronous\mongo_client.py", line 2858, in _get_server
    return self._client._select_server(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self._server_selector,
        ^^^^^^^^^^^^^^^^^^^^^^
    ...<4 lines>...
        operation_id=self._operation_id,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\Users\Tarek\Desktop\crypto project\kassouma\Crypto\.venv\Lib\site-packages\pymongo\synchronous\mongo_client.py", line 1833, in _select_server
    server = topology.select_server(
        server_selector,
    ...<2 lines>...
        operation_id=operation_id,
    )
  File "D:\Users\Tarek\Desktop\crypto project\kassouma\Crypto\.venv\Lib\site-packages\pymongo\synchronous\topology.py", line 409, in select_server
    server = self._select_server(
        selector,
    ...<4 lines>...
        operation_id=operation_id,
    )
  File "D:\Users\Tarek\Desktop\crypto project\kassouma\Crypto\.venv\Lib\site-packages\pymongo\synchronous\topology.py", line 387, in _select_server
    servers = self.select_servers(
        selector, operation, server_selection_timeout, address, operation_id
    )
  File "D:\Users\Tarek\Desktop\crypto project\kassouma\Crypto\.venv\Lib\site-packages\pymongo\synchronous\topology.py", line 294, in select_servers
    server_descriptions = self._select_servers_loop(
        selector, server_timeout, operation, operation_id, address
    )
  File "D:\Users\Tarek\Desktop\crypto project\kassouma\Crypto\.venv\Lib\site-packages\pymongo\synchronous\topology.py", line 344, in _select_servers_loop
    raise ServerSelectionTimeoutError(
        f"{self._error_message(selector)}, Timeout: {timeout}s, Topology Description: {self.description!r}"
    )
pymongo.errors.ServerSelectionTimeoutError: localhost:27017: [WinError 10061] No connection could be made because the target machine actively refused it (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 691a8553c7eb86ce5bd32119, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('localhost:27017: [WinError 10061] No connection could be made because the target machine actively refused it (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
2025-11-16 21:16:17 [INFO] [Hospital_A] Background server thread started.
2025-11-16 21:16:17 [INFO] [Hospital_A] Server listening on 127.0.0.1:65001
2025-11-17 10:30:57 [INFO] [Hospital_A] Initializing node with cryptographic material...
2025-11-17 10:30:57 [INFO] [Hospital_A] Loading private key from 'Hospital_A_private.pem'...
2025-11-17 10:30:57 [INFO] [Hospital_A] PrivateKeyLoaded | source=Hospital_A_private.pem
2025-11-17 10:30:57 [INFO] [Hospital_A] Loading public key from 'Hospital_A_public.pem'...
2025-11-17 10:30:57 [INFO] [Hospital_A] PublicKeyLoaded | owner=Hospital_A | source=Hospital_A_public.pem
2025-11-17 10:30:57 [INFO] [Hospital_A] Directories ready: data_dir='Hospital_A_data', received_dir='Hospital_A_received'
2025-11-17 10:31:27 [ERROR] [Hospital_A] Failed to register hospital in registry (name=Hospital_A): localhost:27017: [WinError 10061] No connection could be made because the target machine actively refused it (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 691b3fb176bb6db21c9ebdcb, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('localhost:27017: [WinError 10061] No connection could be made because the target machine actively refused it (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
Traceback (most recent call last):
  File "D:\Users\Tarek\Desktop\crypto project\kassouma\Crypto\hospital_node.py", line 771, in __init__
    register_hospital(
    ~~~~~~~~~~~~~~~~~^
        name=self.name,
        ^^^^^^^^^^^^^^^
    ...<2 lines>...
        public_key_pem=pub_pem,
        ^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\Users\Tarek\Desktop\crypto project\kassouma\Crypto\registry.py", line 37, in register_hospital
    hospitals_col.update_one({"name": name}, {"$set": doc}, upsert=True)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Users\Tarek\Desktop\crypto project\kassouma\Crypto\.venv\Lib\site-packages\pymongo\synchronous\collection.py", line 1336, in update_one
    self._update_retryable(
    ~~~~~~~~~~~~~~~~~~~~~~^
        filter,
        ^^^^^^^
    ...<11 lines>...
        comment=comment,
        ^^^^^^^^^^^^^^^^
    ),
    ^
  File "D:\Users\Tarek\Desktop\crypto project\kassouma\Crypto\.venv\Lib\site-packages\pymongo\synchronous\collection.py", line 1118, in _update_retryable
    return self._database.client._retryable_write(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        (write_concern or self.write_concern).acknowledged and not multi,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
        operation,
        ^^^^^^^^^^
    )
    ^
  File "D:\Users\Tarek\Desktop\crypto project\kassouma\Crypto\.venv\Lib\site-packages\pymongo\synchronous\mongo_client.py", line 2082, in _retryable_write
    return self._retry_with_session(retryable, func, s, bulk, operation, operation_id)
           ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Users\Tarek\Desktop\crypto project\kassouma\Crypto\.venv\Lib\site-packages\pymongo\synchronous\mongo_client.py", line 1968, in _retry_with_session
    return self._retry_internal(
           ~~~~~~~~~~~~~~~~~~~~^
        func=func,
        ^^^^^^^^^^
    ...<4 lines>...
        operation_id=operation_id,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\Users\Tarek\Desktop\crypto project\kassouma\Crypto\.venv\Lib\site-packages\pymongo\_csot.py", line 125, in csot_wrapper
    return func(self, *args, **kwargs)
  File "D:\Users\Tarek\Desktop\crypto project\kassouma\Crypto\.venv\Lib\site-packages\pymongo\synchronous\mongo_client.py", line 2014, in _retry_internal
    ).run()
      ~~~^^
  File "D:\Users\Tarek\Desktop\crypto project\kassouma\Crypto\.venv\Lib\site-packages\pymongo\synchronous\mongo_client.py", line 2765, in run
    return self._read() if self._is_read else self._write()
                                              ~~~~~~~~~~~^^
  File "D:\Users\Tarek\Desktop\crypto project\kassouma\Crypto\.venv\Lib\site-packages\pymongo\synchronous\mongo_client.py", line 2875, in _write
    self._server = self._get_server()
                   ~~~~~~~~~~~~~~~~^^
  File "D:\Users\Tarek\Desktop\crypto project\kassouma\Crypto\.venv\Lib\site-packages\pymongo\synchronous\mongo_client.py", line 2858, in _get_server
    return self._client._select_server(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self._server_selector,
        ^^^^^^^^^^^^^^^^^^^^^^
    ...<4 lines>...
        operation_id=self._operation_id,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\Users\Tarek\Desktop\crypto project\kassouma\Crypto\.venv\Lib\site-packages\pymongo\synchronous\mongo_client.py", line 1833, in _select_server
    server = topology.select_server(
        server_selector,
    ...<2 lines>...
        operation_id=operation_id,
    )
  File "D:\Users\Tarek\Desktop\crypto project\kassouma\Crypto\.venv\Lib\site-packages\pymongo\synchronous\topology.py", line 409, in select_server
    server = self._select_server(
        selector,
    ...<4 lines>...
        operation_id=operation_id,
    )
  File "D:\Users\Tarek\Desktop\crypto project\kassouma\Crypto\.venv\Lib\site-packages\pymongo\synchronous\topology.py", line 387, in _select_server
    servers = self.select_servers(
        selector, operation, server_selection_timeout, address, operation_id
    )
  File "D:\Users\Tarek\Desktop\crypto project\kassouma\Crypto\.venv\Lib\site-packages\pymongo\synchronous\topology.py", line 294, in select_servers
    server_descriptions = self._select_servers_loop(
        selector, server_timeout, operation, operation_id, address
    )
  File "D:\Users\Tarek\Desktop\crypto project\kassouma\Crypto\.venv\Lib\site-packages\pymongo\synchronous\topology.py", line 344, in _select_servers_loop
    raise ServerSelectionTimeoutError(
        f"{self._error_message(selector)}, Timeout: {timeout}s, Topology Description: {self.description!r}"
    )
pymongo.errors.ServerSelectionTimeoutError: localhost:27017: [WinError 10061] No connection could be made because the target machine actively refused it (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 691b3fb176bb6db21c9ebdcb, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('localhost:27017: [WinError 10061] No connection could be made because the target machine actively refused it (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
2025-11-17 10:31:27 [INFO] [Hospital_A] Background server thread started.
2025-11-17 10:31:27 [INFO] [Hospital_A] Server listening on 127.0.0.1:65001
2025-11-17 10:38:58 [INFO] [Hospital_A] Initializing node with cryptographic material...
2025-11-17 10:38:58 [INFO] [Hospital_A] Loading private key from 'Hospital_A_private.pem'...
2025-11-17 10:38:58 [INFO] [Hospital_A] PrivateKeyLoaded | source=Hospital_A_private.pem
2025-11-17 10:38:58 [INFO] [Hospital_A] Loading public key from 'Hospital_A_public.pem'...
2025-11-17 10:38:58 [INFO] [Hospital_A] PublicKeyLoaded | owner=Hospital_A | source=Hospital_A_public.pem
2025-11-17 10:38:58 [INFO] [Hospital_A] Directories ready: data_dir='Hospital_A_data', received_dir='Hospital_A_received'
2025-11-17 10:38:58 [WARNING] [Hospital_A] Failed to register hospital in registry (name=Hospital_A): name 'pub_pem' is not defined
2025-11-17 10:38:58 [INFO] [Hospital_A] Background server thread started.
2025-11-17 10:38:58 [INFO] [Hospital_A] Server listening on 127.0.0.1:65001
2025-11-17 14:46:42 [INFO] [Hospital_A] Initializing node with cryptographic material...
2025-11-17 14:46:42 [INFO] [Hospital_A] Loading private key from 'Hospital_A_private.pem'...
2025-11-17 14:46:42 [INFO] [Hospital_A] PrivateKeyLoaded | source=Hospital_A_private.pem
2025-11-17 14:46:42 [INFO] [Hospital_A] Loading public key from 'Hospital_A_public.pem'...
2025-11-17 14:46:42 [INFO] [Hospital_A] PublicKeyLoaded | owner=Hospital_A | source=Hospital_A_public.pem
2025-11-17 14:46:42 [INFO] [Hospital_A] Directories ready: data_dir='Hospital_A_data', received_dir='Hospital_A_received'
2025-11-17 14:46:42 [WARNING] [Hospital_A] Failed to register hospital in registry (name=Hospital_A): 'HospitalNode' object has no attribute 'ip'
2025-11-17 14:46:42 [INFO] [Hospital_A] Background server thread started.
2025-11-17 14:46:42 [INFO] [Hospital_A] Server listening on 127.0.0.1:65001
2025-11-18 18:03:51 [INFO] [Hospital_A] Initializing node with cryptographic material...
2025-11-18 18:03:51 [INFO] [Hospital_A] Loading SIGNING private key from 'Hospital_A_sign_private.pem'...
2025-11-18 18:03:51 [INFO] [Hospital_A] SignPrivateKeyLoaded | source=Hospital_A_sign_private.pem
2025-11-18 18:03:51 [INFO] [Hospital_A] Loading ENCRYPTION private key from 'Hospital_A_enc_private.pem'...
2025-11-18 18:03:51 [INFO] [Hospital_A] EncPrivateKeyLoaded | source=Hospital_A_enc_private.pem
2025-11-18 18:03:51 [INFO] [Hospital_A] SignPublicKeyDerived | length=451
2025-11-18 18:03:51 [INFO] [Hospital_A] EncPublicKeyDerived | length=451
2025-11-18 18:03:51 [INFO] [Hospital_A] Directories ready: data_dir='hospital_A_data', received_dir='hospital_A_received'
2025-11-18 18:04:21 [ERROR] [Hospital_A] Failed to register hospital in registry: SSL handshake failed: ac-z9mrurc-shard-00-00.l5vvizb.mongodb.net:27017: [SSL: TLSV1_ALERT_INTERNAL_ERROR] tlsv1 alert internal error (_ssl.c:1032) (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms),SSL handshake failed: ac-z9mrurc-shard-00-01.l5vvizb.mongodb.net:27017: [SSL: TLSV1_ALERT_INTERNAL_ERROR] tlsv1 alert internal error (_ssl.c:1032) (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms),SSL handshake failed: ac-z9mrurc-shard-00-02.l5vvizb.mongodb.net:27017: [SSL: TLSV1_ALERT_INTERNAL_ERROR] tlsv1 alert internal error (_ssl.c:1032) (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 691cfb52c8c8683864e6cf1c, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('ac-z9mrurc-shard-00-00.l5vvizb.mongodb.net', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('SSL handshake failed: ac-z9mrurc-shard-00-00.l5vvizb.mongodb.net:27017: [SSL: TLSV1_ALERT_INTERNAL_ERROR] tlsv1 alert internal error (_ssl.c:1032) (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>, <ServerDescription ('ac-z9mrurc-shard-00-01.l5vvizb.mongodb.net', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('SSL handshake failed: ac-z9mrurc-shard-00-01.l5vvizb.mongodb.net:27017: [SSL: TLSV1_ALERT_INTERNAL_ERROR] tlsv1 alert internal error (_ssl.c:1032) (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>, <ServerDescription ('ac-z9mrurc-shard-00-02.l5vvizb.mongodb.net', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('SSL handshake failed: ac-z9mrurc-shard-00-02.l5vvizb.mongodb.net:27017: [SSL: TLSV1_ALERT_INTERNAL_ERROR] tlsv1 alert internal error (_ssl.c:1032) (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
2025-11-18 18:04:21 [INFO] [Hospital_A] Background server thread started.
2025-11-18 18:04:21 [INFO] [Hospital_A] Server listening on 0.0.0.0:65001
2025-11-18 18:30:27 [INFO] [Hospital_A] Initializing node with cryptographic material...
2025-11-18 18:30:27 [INFO] [Hospital_A] Loading SIGNING private key from 'Hospital_A_sign_private.pem'...
2025-11-18 18:30:27 [INFO] [Hospital_A] SignPrivateKeyLoaded | source=Hospital_A_sign_private.pem
2025-11-18 18:30:27 [INFO] [Hospital_A] Loading ENCRYPTION private key from 'Hospital_A_enc_private.pem'...
2025-11-18 18:30:27 [INFO] [Hospital_A] EncPrivateKeyLoaded | source=Hospital_A_enc_private.pem
2025-11-18 18:30:27 [INFO] [Hospital_A] SignPublicKeyDerived | length=451
2025-11-18 18:30:27 [INFO] [Hospital_A] EncPublicKeyDerived | length=451
2025-11-18 18:30:27 [INFO] [Hospital_A] Directories ready: data_dir='hospital_A_data', received_dir='hospital_A_received'
2025-11-18 18:30:27 [ERROR] [Hospital_A] Failed to register hospital in registry: register_hospital() got an unexpected keyword argument 'sign_public_pem'. Did you mean 'sign_pub_pem'?
2025-11-18 18:30:27 [INFO] [Hospital_A] Background server thread started.
2025-11-18 18:30:27 [INFO] [Hospital_A] Server listening on 0.0.0.0:65001
2025-11-18 18:36:07 [ERROR] [Hospital_A] Unknown target hospital 'Hospital_B' in registry.
2025-11-18 18:36:11 [ERROR] [Hospital_A] Unknown target hospital 'Hospital_B' in registry.
2025-11-18 18:36:12 [ERROR] [Hospital_A] Unknown target hospital 'Hospital_B' in registry.
2025-11-18 18:43:30 [INFO] [Hospital_A] Initializing node with cryptographic material...
2025-11-18 18:43:30 [INFO] [Hospital_A] Loading SIGNING private key from 'Hospital_A_sign_private.pem'...
2025-11-18 18:43:30 [INFO] [Hospital_A] SignPrivateKeyLoaded | source=Hospital_A_sign_private.pem
2025-11-18 18:43:30 [INFO] [Hospital_A] Loading ENCRYPTION private key from 'Hospital_A_enc_private.pem'...
2025-11-18 18:43:30 [INFO] [Hospital_A] EncPrivateKeyLoaded | source=Hospital_A_enc_private.pem
2025-11-18 18:43:30 [INFO] [Hospital_A] SignPublicKeyDerived | length=451
2025-11-18 18:43:30 [INFO] [Hospital_A] EncPublicKeyDerived | length=451
2025-11-18 18:43:30 [INFO] [Hospital_A] Directories ready: data_dir='hospital_A_data', received_dir='hospital_A_received'
2025-11-18 18:43:32 [INFO] [Hospital_A] Registry updated for Hospital_A: host=0.0.0.0, port=65001
2025-11-18 18:43:32 [INFO] [Hospital_A] Background server thread started.
2025-11-18 18:43:32 [INFO] [Hospital_A] Server listening on 0.0.0.0:65001
2025-11-18 18:45:59 [INFO] [Hospital_A] SignMessage_Start | algo=RSA | hash=SHA-256 | message_preview=Request:patient_123.txt
2025-11-18 18:45:59 [INFO] [Hospital_A] SignMessage_Done | signature_len=256 | signature_preview=2b41af71c5264f929388258907e22776...
2025-11-18 18:45:59 [INFO] [Hospital_A] Connecting to Hospital_B at 0.0.0.0:65002...
2025-11-18 18:45:59 [ERROR] [Hospital_A] Error in request_record: [WinError 10049] The requested address is not valid in its context
Traceback (most recent call last):
  File "D:\Users\Tarek\Desktop\crypto project\kassouma\Crypto\hospital_node.py", line 371, in request_record
    s.connect((target_ip, target_port))
    ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
OSError: [WinError 10049] The requested address is not valid in its context
2025-11-18 18:46:09 [INFO] [Hospital_A] SignMessage_Start | algo=RSA | hash=SHA-256 | message_preview=Request:patient_123.txt
2025-11-18 18:46:09 [INFO] [Hospital_A] SignMessage_Done | signature_len=256 | signature_preview=24d92ec9aa07e18e5a4a6ebf0dbf5838...
2025-11-18 18:46:09 [INFO] [Hospital_A] Connecting to Hospital_B at 0.0.0.0:65002...
2025-11-18 18:46:09 [ERROR] [Hospital_A] Error in request_record: [WinError 10049] The requested address is not valid in its context
Traceback (most recent call last):
  File "D:\Users\Tarek\Desktop\crypto project\kassouma\Crypto\hospital_node.py", line 371, in request_record
    s.connect((target_ip, target_port))
    ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
OSError: [WinError 10049] The requested address is not valid in its context
2025-11-18 18:50:20 [INFO] [Hospital_A] Initializing node with cryptographic material...
2025-11-18 18:50:20 [INFO] [Hospital_A] Loading SIGNING private key from 'Hospital_A_sign_private.pem'...
2025-11-18 18:50:20 [INFO] [Hospital_A] SignPrivateKeyLoaded | source=Hospital_A_sign_private.pem
2025-11-18 18:50:20 [INFO] [Hospital_A] Loading ENCRYPTION private key from 'Hospital_A_enc_private.pem'...
2025-11-18 18:50:20 [INFO] [Hospital_A] EncPrivateKeyLoaded | source=Hospital_A_enc_private.pem
2025-11-18 18:50:20 [INFO] [Hospital_A] SignPublicKeyDerived | length=451
2025-11-18 18:50:20 [INFO] [Hospital_A] EncPublicKeyDerived | length=451
2025-11-18 18:50:20 [INFO] [Hospital_A] Directories ready: data_dir='hospital_A_data', received_dir='hospital_A_received'
2025-11-18 18:50:21 [INFO] [Hospital_A] Registry updated for Hospital_A: host=None, port=65001
2025-11-18 18:50:21 [INFO] [Hospital_A] Background server thread started.
2025-11-18 18:50:21 [INFO] [Hospital_A] Server listening on 0.0.0.0:65001
2025-11-18 18:57:10 [INFO] [Hospital_A] Initializing node with cryptographic material...
2025-11-18 18:57:10 [INFO] [Hospital_A] Loading SIGNING private key from 'Hospital_A_sign_private.pem'...
2025-11-18 18:57:10 [INFO] [Hospital_A] SignPrivateKeyLoaded | source=Hospital_A_sign_private.pem
2025-11-18 18:57:10 [INFO] [Hospital_A] Loading ENCRYPTION private key from 'Hospital_A_enc_private.pem'...
2025-11-18 18:57:10 [INFO] [Hospital_A] EncPrivateKeyLoaded | source=Hospital_A_enc_private.pem
2025-11-18 18:57:10 [INFO] [Hospital_A] SignPublicKeyDerived | length=451
2025-11-18 18:57:10 [INFO] [Hospital_A] EncPublicKeyDerived | length=451
2025-11-18 18:57:10 [INFO] [Hospital_A] Directories ready: data_dir='hospital_A_data', received_dir='hospital_A_received'
2025-11-18 18:57:10 [INFO] [Hospital_A] Resolved public host from 0.0.0.0  172.31.45.118
2025-11-18 18:57:11 [INFO] [Hospital_A] Registry updated for Hospital_A: host=172.31.45.118, port=65001
2025-11-18 18:57:11 [INFO] [Hospital_A] Background server thread started.
2025-11-18 18:57:11 [INFO] [Hospital_A] Server listening on 0.0.0.0:65001
2025-11-18 19:09:43 [INFO] [Hospital_A] Initializing node with cryptographic material...
2025-11-18 19:09:43 [INFO] [Hospital_A] Loading SIGNING private key from 'Hospital_A_sign_private.pem'...
2025-11-18 19:09:43 [INFO] [Hospital_A] SignPrivateKeyLoaded | source=Hospital_A_sign_private.pem
2025-11-18 19:09:43 [INFO] [Hospital_A] Loading ENCRYPTION private key from 'Hospital_A_enc_private.pem'...
2025-11-18 19:09:43 [INFO] [Hospital_A] EncPrivateKeyLoaded | source=Hospital_A_enc_private.pem
2025-11-18 19:09:43 [INFO] [Hospital_A] SignPublicKeyDerived | length=451
2025-11-18 19:09:43 [INFO] [Hospital_A] EncPublicKeyDerived | length=451
2025-11-18 19:09:43 [INFO] [Hospital_A] Directories ready: data_dir='hospital_A_data', received_dir='hospital_A_received'
2025-11-18 19:09:44 [INFO] [Hospital_A] Registry updated for Hospital_A: host=127.0.0.1, port=65001
2025-11-18 19:09:44 [INFO] [Hospital_A] Background server thread started.
2025-11-18 19:09:44 [INFO] [Hospital_A] Server listening on 0.0.0.0:65001
2025-11-18 19:10:09 [INFO] [Hospital_A] Initializing node with cryptographic material...
2025-11-18 19:10:09 [INFO] [Hospital_A] Loading SIGNING private key from 'Hospital_A_sign_private.pem'...
2025-11-18 19:10:09 [INFO] [Hospital_A] SignPrivateKeyLoaded | source=Hospital_A_sign_private.pem
2025-11-18 19:10:09 [INFO] [Hospital_A] Loading ENCRYPTION private key from 'Hospital_A_enc_private.pem'...
2025-11-18 19:10:09 [INFO] [Hospital_A] EncPrivateKeyLoaded | source=Hospital_A_enc_private.pem
2025-11-18 19:10:09 [INFO] [Hospital_A] SignPublicKeyDerived | length=451
2025-11-18 19:10:09 [INFO] [Hospital_A] EncPublicKeyDerived | length=451
2025-11-18 19:10:09 [INFO] [Hospital_A] Directories ready: data_dir='hospital_A_data', received_dir='hospital_A_received'
2025-11-18 19:10:10 [INFO] [Hospital_A] Registry updated for Hospital_A: host=127.0.0.1, port=65001
2025-11-18 19:10:10 [INFO] [Hospital_A] Background server thread started.
2025-11-18 19:10:10 [INFO] [Hospital_A] Server listening on 0.0.0.0:65001
2025-11-18 19:10:30 [INFO] [Hospital_A] SignMessage_Start | algo=RSA | hash=SHA-256 | message_preview=Request:patient_123.txt
2025-11-18 19:10:30 [INFO] [Hospital_A] SignMessage_Done | signature_len=256 | signature_preview=b657a623a7f612c5ac4303109ad5097f...
2025-11-18 19:10:30 [INFO] [Hospital_A] Connecting to Hospital_B at 127.0.0.1:65002...
2025-11-18 19:10:30 [INFO] [Hospital_A] Sending secure request for 'patient_123.txt'...
2025-11-18 19:10:30 [WARNING] [Hospital_A] Server error response: Authentication Failed (Missing Keys).
2025-11-18 19:34:49 [INFO] [Hospital_A] Initializing node with cryptographic material...
2025-11-18 19:34:49 [INFO] [Hospital_A] Loading SIGNING private key from 'Hospital_A_sign_private.pem'...
2025-11-18 19:34:50 [INFO] [Hospital_A] SignPrivateKeyLoaded | source=Hospital_A_sign_private.pem
2025-11-18 19:34:50 [INFO] [Hospital_A] Loading ENCRYPTION private key from 'Hospital_A_enc_private.pem'...
2025-11-18 19:34:50 [INFO] [Hospital_A] EncPrivateKeyLoaded | source=Hospital_A_enc_private.pem
2025-11-18 19:34:50 [INFO] [Hospital_A] SignPublicKeyDerived | length=451
2025-11-18 19:34:50 [INFO] [Hospital_A] EncPublicKeyDerived | length=451
2025-11-18 19:34:50 [INFO] [Hospital_A] Directories ready: data_dir='hospital_A_data', received_dir='hospital_A_received'
2025-11-18 19:34:51 [INFO] [Hospital_A] Registry updated for Hospital_A: host=127.0.0.1, port=65001
2025-11-18 19:34:51 [INFO] [Hospital_A] Background server thread started.
2025-11-18 19:34:51 [INFO] [Hospital_A] Server listening on 0.0.0.0:65001
2025-11-18 19:35:01 [INFO] [Hospital_A] Accepted connection from ('127.0.0.1', 12825)
2025-11-18 19:35:01 [INFO] [Hospital_A] Request_Received | from_hospital=Hospital_B | message_preview=Request:patient_123.txt | signature_len=256 | signature_preview=4a19f07b2d2b7c1de4e27ebca66b4d0f...
2025-11-18 19:35:01 [INFO] [Hospital_A] VerifySignature_Start | algo=RSA | hash=SHA-256
2025-11-18 19:35:01 [INFO] [Hospital_A] VerifySignature_Success | note=Requester authenticated
2025-11-18 19:35:01 [WARNING] [Hospital_A] Requested file not found: hospital_A_data\patient_123.txt
2025-11-18 19:35:01 [INFO] [Hospital_A] Connection from Hospital_B closed.
2025-11-18 19:35:08 [INFO] [Hospital_A] SignMessage_Start | algo=RSA | hash=SHA-256 | message_preview=Request:patient_123.txt
2025-11-18 19:35:08 [INFO] [Hospital_A] SignMessage_Done | signature_len=256 | signature_preview=545e2f5ddae7fa1ff33927382bc1cc24...
2025-11-18 19:35:08 [INFO] [Hospital_A] Connecting to Hospital_B at 127.0.0.1:65002...
2025-11-18 19:35:08 [INFO] [Hospital_A] Sending secure request for 'patient_123.txt'...
2025-11-18 19:35:11 [INFO] [Hospital_A] Encrypted package received, decoding JSON...
2025-11-18 19:35:11 [INFO] [Hospital_A] EncryptedPackage_Received | enc_keys_len=256 | iv_hex=3a25c88346780d32e710100cf3e69168 | ciphertext_len=112 | hmac_len=32 | hmac_preview=092ce942026b93201b979ee5a00ac0e4...
2025-11-18 19:35:11 [INFO] [Hospital_A] RSA_DecryptKeys_Start | algo=RSA | enc_keys_len=256
2025-11-18 19:35:11 [INFO] [Hospital_A] RSA_DecryptKeys_Done | combined_len=64 | combined_preview=5016b93c4c6481d0dc08e28f2cbc180d...
2025-11-18 19:35:11 [INFO] [Hospital_A] SessionKeys_Derived | aes_key_len=32 | aes_key_preview=5016b93c4c6481d0... | hmac_key_len=32 | hmac_key_preview=ef15dc2fe3b20d44...
2025-11-18 19:35:11 [INFO] [Hospital_A] HMAC_Verify_Start | algo=HMAC-SHA256 | ciphertext_len=112
2025-11-18 19:35:11 [INFO] [Hospital_A] HMAC_Verify_Success | note=Integrity OK
2025-11-18 19:35:11 [INFO] [Hospital_A] AES_Decrypt_Start | algo=AES-256-CBC | ciphertext_len=112 | iv_hex=3a25c88346780d32e710100cf3e69168
2025-11-18 19:35:11 [INFO] [Hospital_A] AES_Decrypt_Done | plaintext_len=103 | plaintext_preview=50415449454e54205245434f52443a20...
2025-11-18 19:35:11 [INFO] [Hospital_A] Decrypted record saved to 'hospital_A_received\RECEIVED_patient_123.txt'
